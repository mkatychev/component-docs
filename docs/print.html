<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>The WebAssembly Component Model</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->
        <script defer data-domain="component-model.bytecodealliance.org" src="https://plausible.io/js/script.js"></script>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="theme/head.hbs">


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The WebAssembly Component Model</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/bytecodealliance/component-docs/tree/main/component-model" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="home"><a class="header" href="#home">Home</a></h1>
<p>The WebAssembly Component Model is a broad-reaching architecture for building interoperable Wasm libraries, applications, and environments.</p>
<div class="table-wrapper"><table><thead><tr><th>Understanding components</th><th>Building components</th><th>Using components</th></tr></thead><tbody>
<tr><td><a href="./design/why-component-model.html">Why Components?</a></td><td><a href="./language-support/c.html">C/C++</a></td><td><a href="./creating-and-consuming/composing.html">Composing</a></td></tr>
<tr><td><a href="./design/components.html">Components</a></td><td><a href="./language-support/csharp.html">C#</a></td><td><a href="./creating-and-consuming/running.html">Running</a></td></tr>
<tr><td><a href="./design/interfaces.html">Interfaces</a></td><td><a href="./language-support/go.html">Go</a></td><td><a href="./creating-and-consuming/distributing.html">Distributing</a></td></tr>
<tr><td><a href="./design/worlds.html">Worlds</a></td><td><a href="./language-support/javascript.html">JavaScript</a></td><td></td></tr>
<tr><td></td><td><a href="./language-support/python.html">Python</a></td><td></td></tr>
<tr><td></td><td><a href="./language-support/rust.html">Rust</a></td><td></td></tr>
</tbody></table>
</div>
<blockquote>
<p>This documentation is aimed at <em>users</em> of the component model: developers of libraries and applications. <em>Compiler and Wasm runtime developers</em> can take a look at the <a href="https://github.com/WebAssembly/component-model">Component Model specification</a> to see how to add support for the component model to their project.</p>
</blockquote>
<h2 id="status"><a class="header" href="#status">Status</a></h2>
<p><a href="https://github.com/WebAssembly/WASI/pull/577">WASI 0.2.0 was released</a> Jan 25, 2024, providing a stable release of WASI and the component model. This <a href="https://github.com/WebAssembly/WASI/tree/main/preview2">is a stable set of WIT definitions</a> that components can target. WASI proposals will continue to evolve and new ones will be introduced; however, users of the component model can now pin to the stable 0.2.0 release.</p>
<h2 id="contributing"><a class="header" href="#contributing">Contributing</a></h2>
<p>If you find a mistake, omission, ambiguity, or other problem, please let us know via <a href="https://github.com/bytecodealliance/component-docs/issues">GitHub issues</a>.</p>
<p>If you'd like to contribute content to the guide, please see the <a href="https://github.com/bytecodealliance/component-docs/blob/main/CONTRIBUTING.md">contribution guide</a> for information on how to contribute.</p>
<div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="why-the-component-model"><a class="header" href="#why-the-component-model">Why the Component Model?</a></h1>
<p>If you've tried out WebAssembly, you'll be familiar with the concept of a <em>module</em>. Roughly speaking, a module corresponds to a single <code>.wasm</code> file, with functions, memory, imports and exports, and so on. These "core" modules can run in the browser, or via a separate runtime such as Wasmtime or WAMR. A module is defined by the <a href="https://webassembly.github.io/spec/core/">WebAssembly Core Specification</a>, and if you compile a program written in Rust, C, Go or whatever to WebAssembly, then a core module is what you'll get.</p>
<p>Core modules are, however, limited in how they expose their functionality to the outside world to functions that take and return only a small number of core WebAssembly types (essentially only integers and floating-point numbers). Richer types, such as strings, lists, records (a.k.a. structs), etc. have to be represented in terms of integers and floating point numbers, for example by the use of pointers and offsets. Those representations are often times not interchangeable across languages. For example, a string in C might be represented entirely differently from a string in Rust or in JavaScript.</p>
<p>For Wasm modules to interoperate, therefore, there needs to be an agreed-upon way for exposing those richer types across module boundaries.</p>
<p>In the component model, these type definitions are written in a language called <a href="design/./wit.html">WIT (Wasm Interface Type)</a>, and the way they translate into bits and bytes is called the <a href="design/./../advanced/canonical-abi.html">Canonical ABI (Application Binary Interface)</a>. A Wasm <a href="design/./components.html">component</a> is thus a wrapper around a core module that specifies its imports and exports using such <a href="design/./interfaces.html">Interfaces</a>.</p>
<p>The agreement of an interface adds a new dimension to Wasm portability. Not only are components portable across architectures and operating systems, but they are now portable across languages. A Go component can communicate directly and safely with a C or Rust component. It need not even know which language another component was written in - it needs only the component interface, expressed in WIT. Additionally, components can be linked into larger graphs, with one component's exports satisfying another's imports.</p>
<p>Combined with Wasm's strong sandboxing, this opens the door to yet further benefits. By expressing higher-level semantics than integers and floats, it becomes possible to statically analyse and reason about a component's behaviour - to enforce and guarantee properties just by looking at the surface of the component. The relationships within a graph of components can be analysed, for example to verify that a component containing business logic has no access to a component containing personally identifiable information.</p>
<p>Moreover, a component interacts with a runtime or other components <em>only</em> by calling its imports and having its exports called. Specifically, unlike core modules, a component may not export Wasm memory, and thus it cannot indirectly communicate to others by writing to its memory and having others read from that memory. This not only reinforces sandboxing, but enables interoperation between languages that make different assumptions about memory - for example, allowing a component that relies on Wasm GC (garbage collected) memory to collaborate with one that uses conventional linear memory.</p>
<p>Now that you have a better idea about how the component model can help you, take a look at <a href="design/../language-support.html">how to build components</a> in your favorite language!</p>
<blockquote>
<p>For more background on why the component model was created, take a look at the specification's <a href="https://github.com/WebAssembly/component-model/blob/main/design/high-level/Goals.md">goals</a>, <a href="https://github.com/WebAssembly/component-model/blob/main/design/high-level/UseCases.md">use cases</a> and <a href="https://github.com/WebAssembly/component-model/blob/main/design/high-level/Choices.md">design choices</a>.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="components"><a class="header" href="#components">Components</a></h1>
<ul>
<li>Logically, components are containers for modules - or other components - which express their <a href="design/./interfaces.html">interfaces</a> and dependencies via <a href="design/./wit.html">WIT</a>.</li>
<li>Conceptually, components are self-describing units of code that interact only through interfaces instead of shared memory.</li>
<li>Physically, a <strong>component</strong> is a specially-formatted WebAssembly file. Internally, the component could include multiple traditional ("core") WebAssembly modules, and sub-components, composed via their imports and exports.</li>
</ul>
<p>The external interface of a component - its imports and exports - corresponds to a <a href="design/./worlds.html">world</a>. The component, however, internally defines how that world is implemented.</p>
<blockquote>
<p>For a more formal definition of what a component is, take a look at the <a href="https://github.com/WebAssembly/component-model">Component Model specification</a>.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="interfaces"><a class="header" href="#interfaces">Interfaces</a></h1>
<p>An <strong>interface</strong> describes a single-focus, composable contract, through which components can interact with each other and with hosts. Interfaces describe the types and functions used to carry out that interaction. For example:</p>
<ul>
<li>A "receive HTTP requests" interface might have only a single "handle request" function, but contain types representing incoming requests, outgoing responses, HTTP methods and headers, and so on.</li>
<li>A "wall clock" interface might have two functions, one to get the current time and one to get the granularity of the timer. It would also include a type to represent an instant in time.</li>
</ul>
<p>Interfaces are defined using <a href="design/./wit.html">the WIT language</a>.</p>
<blockquote>
<p>For a more formal definition of what an interface is, take a look at the <a href="https://github.com/WebAssembly/component-model/blob/main/design/mvp/WIT.md">WIT specification</a>.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="wit-worlds"><a class="header" href="#wit-worlds">WIT Worlds</a></h1>
<p>A <strong>WIT world</strong> is a higher-level contract that describes a component's capabilities and needs.</p>
<p>On one hand, a world describes the shape of a component - it says which interfaces the component exposes for other code to call (its exports), and which interfaces the component depends on (its imports). A world only defines the surface of a component, not the internal behaviour. If you're an application or library developer creating a component, you'll specify the world your component targets. This world describes the functionality your component exposes and declares the functionality your component depends on in order to be able to run. Your component may target a custom world definition you have created with a unique set of imports and exports tailored just for your use case, or it may target an existing world definition that someone else has already specified.</p>
<p>On the other hand though, a world defines a <em>hosting environment</em> for components (i.e., an environment in which a component can be instantiated and its functionality can be invoked). An environment supports a world by providing implementations for all of the imports and by optionally invoking one or more of the exports.</p>
<p>For example, WASI (the WebAssembly System Interface) defines a "command line" world which imports interfaces that command line programs typically expect to have available to them such as file I/O, random number generation, clocks and so on. This world has a single export for running the command line tool. Components targeting this world must provide an implementation for this single export, and they may optionally call any of the imports. On the other hand, environments supporting this world must provide implementations for all of the imports and may invoke the single export.</p>
<p>A world is composed of interfaces, but each interface is <em>directional</em> - it indicates whether the interface is available for outside code to call (an "export"), or whether outside code must fulfill the interface for the component to call (an "import"). These interfaces strictly bound the component. A component cannot interact with anything outside itself except by having its exports called, or by it calling its imports. This provides very strong sandboxing; for example, if a component does not have an import for a secret store, then it <em>cannot</em> access that secret store, even if the store is running in the same process.</p>
<p>For a component to run, its imports must be fulfilled, by a host or by other components. Connecting up some or all of a component's imports to other components' matching exports is called <em>composition</em>.</p>
<h2 id="example-worlds"><a class="header" href="#example-worlds">Example Worlds</a></h2>
<ul>
<li>A (trivial) "HTTP proxy" world would export a "handle HTTP requests" interface, and import a "send HTTP requests" interface. A host, or another component, would call the exported "handle" interface, passing an HTTP request; the component would forward it on via the imported "send" interface. To be a <em>useful</em> proxy, the component may also need to import interfaces such as I/O and clock time - without those imports the component could not perform, for example, on-disk caching.</li>
<li>A "regex parser" world would export a "parse regex" function, and would import nothing. This declares not only that the component implementing this world can parse regular expressions, but also that it calls no other APIs. A user of such a parser could know, without looking at the implementation, that is does not access the file system, or send the user's regexes to a network service.</li>
</ul>
<blockquote>
<p>For a more formal definition of what a WIT world is, take a look at the <a href="https://github.com/WebAssembly/component-model/blob/main/design/mvp/WIT.md#wit-worlds">WIT world specification</a>.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="an-overview-of-wit"><a class="header" href="#an-overview-of-wit">An Overview of WIT</a></h1>
<p>The WIT (Wasm Interface Type) language is used to define Component Model <a href="design/wit.html#interfaces">interfaces</a> and <a href="design/wit.html#worlds">worlds</a>. WIT isn't a general-purpose coding language and doesn't define behaviour; it defines only <em>contracts</em> between components. This topic provides an overview of key elements of the WIT language. The official WIT specification and history can be found in the <a href="https://github.com/WebAssembly/component-model/blob/main/design/mvp/WIT.md"><code>WebAssembly/component-model</code> repository</a>.</p>
<ul>
<li><a href="design/wit.html#an-overview-of-wit">An Overview of WIT</a>
<ul>
<li><a href="design/wit.html#structure-of-a-wit-file">Structure of a WIT file</a></li>
<li><a href="design/wit.html#comments">Comments</a></li>
<li><a href="design/wit.html#documentation">Documentation</a></li>
<li><a href="design/wit.html#identifiers">Identifiers</a></li>
<li><a href="design/wit.html#built-in-types">Built-in types</a>
<ul>
<li><a href="design/wit.html#primitive-types">Primitive types</a></li>
<li><a href="design/wit.html#lists">Lists</a></li>
<li><a href="design/wit.html#options">Options</a></li>
<li><a href="design/wit.html#results">Results</a></li>
<li><a href="design/wit.html#tuples">Tuples</a></li>
</ul>
</li>
<li><a href="design/wit.html#user-defined-types">User-defined types</a>
<ul>
<li><a href="design/wit.html#records">Records</a></li>
<li><a href="design/wit.html#variants">Variants</a></li>
<li><a href="design/wit.html#enums">Enums</a></li>
<li><a href="design/wit.html#resources">Resources</a></li>
<li><a href="design/wit.html#flags">Flags</a></li>
<li><a href="design/wit.html#type-aliases">Type aliases</a></li>
</ul>
</li>
<li><a href="design/wit.html#functions">Functions</a></li>
<li><a href="design/wit.html#interfaces">Interfaces</a>
<ul>
<li><a href="design/wit.html#using-definitions-from-elsewhere">Using definitions from elsewhere</a></li>
</ul>
</li>
<li><a href="design/wit.html#worlds">Worlds</a>
<ul>
<li><a href="design/wit.html#interfaces-from-other-packages">Interfaces from other packages</a></li>
<li><a href="design/wit.html#inline-interfaces">Inline interfaces</a></li>
<li><a href="design/wit.html#including-other-worlds">Including other worlds</a></li>
</ul>
</li>
<li><a href="design/wit.html#packages">Packages</a></li>
</ul>
</li>
</ul>
<h2 id="structure-of-a-wit-file"><a class="header" href="#structure-of-a-wit-file">Structure of a WIT file</a></h2>
<p>A WIT file contains one or more <strong>interfaces</strong> or <strong>worlds</strong>. An interface or world can define <strong>types</strong> and/or <strong>functions</strong>.</p>
<blockquote>
<p>Types and functions can't be defined outside of interfaces or worlds.</p>
</blockquote>
<p>A file may optionally start with a <strong>package</strong> declaration.</p>
<h2 id="comments"><a class="header" href="#comments">Comments</a></h2>
<p>WIT comment syntax is similar to the one used by the C++ family of languages:</p>
<ul>
<li>Everything from <code>//</code> to end of line is a comment.</li>
<li>Any text enclosed in <code>/*</code> ... <code>*/</code> is a comment.
<ul>
<li>Unlike the C++ family, block comments <em>can</em> be nested, e.g. <code>/* blah /* rabbit */ rhubarb */</code>.</li>
</ul>
</li>
</ul>
<h2 id="documentation"><a class="header" href="#documentation">Documentation</a></h2>
<p>WIT defines special comment formats for documentation:</p>
<ul>
<li>Everything from <code>///</code> to end of line is documentation for the following item.</li>
<li>Any text enclosed in <code>/**</code> ... <code>*/</code> is documentation for the following item.</li>
</ul>
<p>For example:</p>
<pre><code class="language-treesitter">&lt;span class='hljs-comment'&gt;/// Prints "hello".&lt;/span&gt;
print-hello&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-keyword'&gt;func&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;(&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;)&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;

&lt;span class='hljs-comment'&gt;/**
Prints "hello".
*/&lt;/span&gt;
print-hello&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-keyword'&gt;func&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;(&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;)&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;
</code></pre>
<h2 id="identifiers"><a class="header" href="#identifiers">Identifiers</a></h2>
<p>WIT identifiers have a slightly different set of rules from what you might be familiar with from, say, C, Rust, or Java.  These rules apply to all names - types, functions, interfaces, and worlds. (Package identifiers are a little more complex and will be covered in the <a href="design/wit.html#packages">Packages section</a>.)</p>
<ul>
<li>Identifiers are restricted to ASCII <code>kebab-case</code> - sequences of words, separated by single hyphens.
<ul>
<li>Double hyphens (<code>--</code>) are not allowed.</li>
<li>Hyphens aren't allowed at the beginning or end of the sequence, only between words.</li>
</ul>
</li>
<li>An identifier may be preceded by a single <code>%</code> sign.
<ul>
<li>This is <em>required</em> if the identifier would otherwise be a WIT keyword. For example, <code>interface</code> is <strong>not</strong> a legal identifier, but <code>%interface</code> is legal.</li>
</ul>
</li>
<li>Each word in the sequence must begin with an ASCII letter, and may contain only ASCII letters and digits.
<ul>
<li>A word cannot begin with a digit.</li>
<li>A word cannot contain a non-ASCII Unicode character.</li>
<li>A word cannot contain punctuation, underscores, etc.</li>
</ul>
</li>
<li>Each word must be either all <code>lowercase</code> or all <code>UPPERCASE</code>.
<ul>
<li>Different words in the identifier may have different cases. For example, <code>WIT-demo</code> is allowed.</li>
</ul>
</li>
<li>An identifier cannot be a WIT keyword such as <code>interface</code> (unless preceded by a <code>%</code> sign).</li>
</ul>
<h2 id="built-in-types"><a class="header" href="#built-in-types">Built-in types</a></h2>
<p>The types in this section are defined by the WIT language itself.</p>
<h3 id="primitive-types"><a class="header" href="#primitive-types">Primitive types</a></h3>
<p>WIT defines the following primitive types:</p>
<div class="table-wrapper"><table><thead><tr><th>Identifier</th><th>Description</th></tr></thead><tbody>
<tr><td><code>bool</code></td><td>Boolean value <code>true</code> or <code>false</code>.</td></tr>
<tr><td><code>s8</code>, <code>s16</code>, <code>s32</code>, <code>s64</code></td><td>Signed integers of the appropriate width. For example, <code>s32</code> is a signed 32-bit integer.</td></tr>
<tr><td><code>u8</code>, <code>u16</code>, <code>u32</code>, <code>u64</code></td><td>Unsigned integers of the appropriate width. For example, <code>u32</code> is an unsigned 32-bit integer.</td></tr>
<tr><td><code>f32</code>, <code>f64</code></td><td>Floating-point numbers of the appropriate width. For example, <code>f64</code> is a 64-bit (double precision) floating-point number. See the note on <code>NaN</code>s below.</td></tr>
<tr><td><code>char</code></td><td>Unicode character. (Specifically, a <a href="https://unicode.org/glossary/#unicode_scalar_value">Unicode scalar value</a>.)</td></tr>
<tr><td><code>string</code></td><td>A Unicode string - that is, a finite sequence of characters.</td></tr>
</tbody></table>
</div>
<blockquote>
<p>The <code>f32</code> and <code>f64</code> types support the usual set of IEEE 754 single and double-precision values, except that they logically only have a single <code>nan</code> value. The exact bit-level representation of an IEEE 754 <code>NaN</code> is not guaranteed to be preserved when values pass through WIT interfaces as the singular WIT <code>nan</code> value.</p>
</blockquote>
<h3 id="lists"><a class="header" href="#lists">Lists</a></h3>
<p><code>list&lt;T&gt;</code> for any type <code>T</code> denotes an ordered sequence of values of type <code>T</code>.  <code>T</code> can be any type, built-in or user-defined:</p>
<pre><code class="language-treesitter">&lt;span class='hljs-type'&gt;list&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;&amp;lt;&lt;/span&gt;&lt;span class='hljs-type'&gt;u8&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;&amp;gt;&lt;/span&gt;       &lt;span class='hljs-comment'&gt;// byte buffer&lt;/span&gt;
&lt;span class='hljs-type'&gt;list&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;&amp;lt;&lt;/span&gt;customer&lt;span class='hljs-punctuation'&gt;&amp;gt;&lt;/span&gt; &lt;span class='hljs-comment'&gt;// a list of customers&lt;/span&gt;
</code></pre>
<p>This is similar to Rust <code>Vec</code>, or Java <code>List</code>.</p>
<h3 id="options"><a class="header" href="#options">Options</a></h3>
<p><code>option&lt;T&gt;</code> for any type <code>T</code> may contain a value of type <code>T</code>, or may contain no value.  <code>T</code> can be any type, built-in or user-defined.  For example, a lookup function might return an option, allowing for the possibility that the lookup key wasn't found:</p>
<pre><code class="language-treesitter">&lt;span class='hljs-type'&gt;option&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;&amp;lt;&lt;/span&gt;customer&lt;span class='hljs-punctuation'&gt;&amp;gt;&lt;/span&gt;
</code></pre>
<p>This is similar to Rust <code>Option</code>, C++ <code>std::optional</code>, or Haskell <code>Maybe</code>.</p>
<blockquote>
<p>This is a special case of a <a href="design/wit.html#variants">variant</a> type.  WIT defines it so that there is a common way of expressing it, so that you don't need to create a variant type for every value type, and to enable it to be mapped idiomatically into languages with option types.</p>
</blockquote>
<h3 id="results"><a class="header" href="#results">Results</a></h3>
<p><code>result&lt;T, E&gt;</code> for any types <code>T</code> and <code>E </code>may contain a value of type <code>T</code> <em>or</em> a value of type <code>E</code> (but not both). This is typically used for "value or error" situations; for example, a HTTP request function might return a result, with the success case (the <code>T</code> type) representing a HTTP response, and the error case (the <code>E</code> type) representing the various kinds of error that might occur:</p>
<pre><code class="language-treesitter">&lt;span class='hljs-type'&gt;result&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;&amp;lt;&lt;/span&gt;http-response&lt;span class='hljs-punctuation'&gt;,&lt;/span&gt; http-error&lt;span class='hljs-punctuation'&gt;&amp;gt;&lt;/span&gt;
</code></pre>
<p>This is similar to Rust <code>Result</code>, or Haskell <code>Either</code>.</p>
<blockquote>
<p>This is a special case of a <a href="design/wit.html#variants">variant</a> type.  WIT defines it so that there is a common way of expressing it, so that you don't need to create a variant type for every combination of value and error types, and to enable it to be mapped idiomatically into languages with result or "either" types.</p>
</blockquote>
<p>Sometimes there is no data associated with one or both of the cases. For example, a <code>print</code> function could return an error code if it fails, but has nothing to return if it succeeds. In this case, you can omit the corresponding type as follows:</p>
<pre><code class="language-treesitter">&lt;span class='hljs-type'&gt;result&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;&amp;lt;&lt;/span&gt;&lt;span class='hljs-type'&gt;u32&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;&amp;gt;&lt;/span&gt;     &lt;span class='hljs-comment'&gt;// no data associated with the error case&lt;/span&gt;
&lt;span class='hljs-type'&gt;result&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;&amp;lt;&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;_&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;,&lt;/span&gt; &lt;span class='hljs-type'&gt;u32&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;&amp;gt;&lt;/span&gt;  &lt;span class='hljs-comment'&gt;// no data associated with the success case&lt;/span&gt;
&lt;span class='hljs-type'&gt;result&lt;/span&gt;          &lt;span class='hljs-comment'&gt;// no data associated with either case&lt;/span&gt;
</code></pre>
<h3 id="tuples"><a class="header" href="#tuples">Tuples</a></h3>
<p>A <code>tuple</code> type is an ordered <em>fixed length</em> sequence of values of specified types. It is similar to a <a href="design/wit.html#records"><em>record</em></a>, except that the fields are identified by their order instead of by names.</p>
<pre><code class="language-treesitter">&lt;span class='hljs-type'&gt;tuple&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;&amp;lt;&lt;/span&gt;&lt;span class='hljs-type'&gt;u64&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;,&lt;/span&gt; &lt;span class='hljs-type'&gt;string&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;&amp;gt;&lt;/span&gt;      &lt;span class='hljs-comment'&gt;// An integer and a string&lt;/span&gt;
&lt;span class='hljs-type'&gt;tuple&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;&amp;lt;&lt;/span&gt;&lt;span class='hljs-type'&gt;u64&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;,&lt;/span&gt; &lt;span class='hljs-type'&gt;string&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;,&lt;/span&gt; &lt;span class='hljs-type'&gt;u64&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;&amp;gt;&lt;/span&gt; &lt;span class='hljs-comment'&gt;// An integer, then a string, then an integer&lt;/span&gt;
</code></pre>
<p>This is similar to tuples in Rust or OCaml.</p>
<h2 id="user-defined-types"><a class="header" href="#user-defined-types">User-defined types</a></h2>
<p>You can define your own types within an <code>interface</code> or <code>world</code>. WIT offers several ways of defining new types.</p>
<h3 id="records"><a class="header" href="#records">Records</a></h3>
<p>A <code>record</code> type declares a set of named fields, each of the form <code>name: type</code>, separated by commas. A record instance contains a value for every field. Field types can be built-in or user-defined. The syntax is as follows:</p>
<pre><code class="language-treesitter">&lt;span class='hljs-keyword'&gt;record&lt;/span&gt; customer &lt;span class='hljs-punctuation'&gt;{&lt;/span&gt;
    id&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-type'&gt;u64&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;,&lt;/span&gt;
    name&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-type'&gt;string&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;,&lt;/span&gt;
    picture&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-type'&gt;option&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;&amp;lt;&lt;/span&gt;&lt;span class='hljs-type'&gt;list&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;&amp;lt;&lt;/span&gt;&lt;span class='hljs-type'&gt;u8&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;&amp;gt;&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;&amp;gt;&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;,&lt;/span&gt;
    account-manager&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; employee&lt;span class='hljs-punctuation'&gt;,&lt;/span&gt;
&lt;span class='hljs-punctuation'&gt;}&lt;/span&gt;
</code></pre>
<p>Records are similar to C or Rust <code>struct</code>s.</p>
<blockquote>
<p>User-defined records can't be generic (that is, parameterised by type). Only built-in types can be generic.</p>
</blockquote>
<h3 id="variants"><a class="header" href="#variants">Variants</a></h3>
<p>A <code>variant</code> type declares one or more cases. Each case has a name and, optionally, a type of data associated with that case. A variant instance contains exactly one case. Cases are separated by commas. The syntax is as follows:</p>
<pre><code class="language-treesitter">&lt;span class='hljs-keyword'&gt;variant&lt;/span&gt; allowed-destinations &lt;span class='hljs-punctuation'&gt;{&lt;/span&gt;
    none&lt;span class='hljs-punctuation'&gt;,&lt;/span&gt;
    any&lt;span class='hljs-punctuation'&gt;,&lt;/span&gt;
    restricted&lt;span class='hljs-punctuation'&gt;(&lt;/span&gt;&lt;span class='hljs-type'&gt;list&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;&amp;lt;&lt;/span&gt;address&lt;span class='hljs-punctuation'&gt;&amp;gt;&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;)&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;,&lt;/span&gt;
&lt;span class='hljs-punctuation'&gt;}&lt;/span&gt;
</code></pre>
<p>Variants are similar to Rust <code>enum</code>s or OCaml discriminated unions. The closest C equivalent is a tagged union, but WIT both takes care of the "tag" (the case) and enforces the correct data shape for each tag.</p>
<blockquote>
<p>User-defined variants can't be generic (that is, parameterised by type). Only built-in types can be generic.</p>
</blockquote>
<h3 id="enums"><a class="header" href="#enums">Enums</a></h3>
<p>An <code>enum</code> type is a variant type where none of the cases have associated data:</p>
<pre><code class="language-treesitter">&lt;span class='hljs-keyword'&gt;enum&lt;/span&gt; color &lt;span class='hljs-punctuation'&gt;{&lt;/span&gt;
    hot-pink&lt;span class='hljs-punctuation'&gt;,&lt;/span&gt;
    lime-green&lt;span class='hljs-punctuation'&gt;,&lt;/span&gt;
    navy-blue&lt;span class='hljs-punctuation'&gt;,&lt;/span&gt;
&lt;span class='hljs-punctuation'&gt;}&lt;/span&gt;
</code></pre>
<p>This can provide a simpler representation in languages without discriminated unions. For example, a WIT <code>enum</code> can translate directly to a C++ <code>enum</code>.</p>
<h3 id="resources"><a class="header" href="#resources">Resources</a></h3>
<p>Resources are handles to some entity that lives outside of the component. They
describe things that can't or shouldn't be copied by value; instead, their
ownership or reference can be passed between two components via a handle. Unlike
other WIT types which are simply plain data, resources only expose behavior
through methods. Resources can be thought of as <em>objects that implement</em> an
interface.</p>
<p>For example, we could model a blob (binary large object) as a resource. The
following WIT defines the <code>blob</code> resource type, which contains a constructor,
two methods, and a static function:</p>
<pre><code class="language-treesitter">&lt;span class='hljs-keyword'&gt;resource&lt;/span&gt; blob &lt;span class='hljs-punctuation'&gt;{&lt;/span&gt;
    constructor&lt;span class='hljs-punctuation'&gt;(&lt;/span&gt;init&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-type'&gt;list&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;&amp;lt;&lt;/span&gt;&lt;span class='hljs-type'&gt;u8&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;&amp;gt;&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;)&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;
    write&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-keyword'&gt;func&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;(&lt;/span&gt;bytes&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-type'&gt;list&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;&amp;lt;&lt;/span&gt;&lt;span class='hljs-type'&gt;u8&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;&amp;gt;&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;)&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;
    read&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-keyword'&gt;func&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;(&lt;/span&gt;n&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-type'&gt;u32&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;)&lt;/span&gt; &lt;span class='hljs-punctuation'&gt;-&amp;gt;&lt;/span&gt; &lt;span class='hljs-type'&gt;list&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;&amp;lt;&lt;/span&gt;&lt;span class='hljs-type'&gt;u8&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;&amp;gt;&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;
    merge&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-keyword'&gt;static&lt;/span&gt; &lt;span class='hljs-keyword'&gt;func&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;(&lt;/span&gt;lhs&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; blob&lt;span class='hljs-punctuation'&gt;,&lt;/span&gt; rhs&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; blob&lt;span class='hljs-punctuation'&gt;)&lt;/span&gt; &lt;span class='hljs-punctuation'&gt;-&amp;gt;&lt;/span&gt; blob&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;
&lt;span class='hljs-punctuation'&gt;}&lt;/span&gt;
</code></pre>
<p>As shown in the <code>blob</code> example, a resource can contain:</p>
<ul>
<li><em>methods</em>: functions that implicitly take a <code>self</code> (often called <code>this</code> in many languages)
parameter that is a handle</li>
<li><em>static functions</em>: functions which do not have an implicit <code>self</code> parameter
but are meant to be nested in the scope of the resource type</li>
<li>at most one <em>constructor</em>: a function that is syntactic sugar for a function
returning a handle of the containing resource type</li>
</ul>
<p>Methods always desugar to a borrowed <code>self</code> parameter whereas constructors
always desugar to an owned return value. For example, the <code>blob</code> resource
<a href="design/wit.html#resources">above</a> could be approximated as:</p>
<pre><code class="language-treesitter">&lt;span class='hljs-keyword'&gt;resource&lt;/span&gt; blob&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;
blob-constructor&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-keyword'&gt;func&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;(&lt;/span&gt;bytes&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-type'&gt;list&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;&amp;lt;&lt;/span&gt;&lt;span class='hljs-type'&gt;u8&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;&amp;gt;&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;)&lt;/span&gt; &lt;span class='hljs-punctuation'&gt;-&amp;gt;&lt;/span&gt; blob&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;
blob-write&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-keyword'&gt;func&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;(&lt;/span&gt;self&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-type'&gt;borrow&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;&amp;lt;&lt;/span&gt;blob&lt;span class='hljs-punctuation'&gt;&amp;gt;&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;,&lt;/span&gt; bytes&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-type'&gt;list&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;&amp;lt;&lt;/span&gt;&lt;span class='hljs-type'&gt;u8&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;&amp;gt;&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;)&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;
blob-read&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-keyword'&gt;func&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;(&lt;/span&gt;self&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-type'&gt;borrow&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;&amp;lt;&lt;/span&gt;blob&lt;span class='hljs-punctuation'&gt;&amp;gt;&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;,&lt;/span&gt; n&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-type'&gt;u32&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;)&lt;/span&gt; &lt;span class='hljs-punctuation'&gt;-&amp;gt;&lt;/span&gt; &lt;span class='hljs-type'&gt;list&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;&amp;lt;&lt;/span&gt;&lt;span class='hljs-type'&gt;u8&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;&amp;gt;&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;
blob-merge&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-keyword'&gt;static&lt;/span&gt; &lt;span class='hljs-keyword'&gt;func&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;(&lt;/span&gt;lhs&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; blob&lt;span class='hljs-punctuation'&gt;,&lt;/span&gt; rhs&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; blob&lt;span class='hljs-punctuation'&gt;)&lt;/span&gt; &lt;span class='hljs-punctuation'&gt;-&amp;gt;&lt;/span&gt; blob&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;
</code></pre>
<p>When a <code>resource</code> type name is wrapped with <code>borrow&lt;...&gt;</code>, it stands for a
"borrowed" resource. A borrowed resource represents a temporary loan of a resource from the
caller to the callee for the duration of the call. In contrast, when the owner
of an owned resource drops that resource, the resource is destroyed.</p>
<blockquote>
<p>More precisely, these are borrowed or owned <code>handles</code> of the resource. Learn more about <code>handles</code> in the <a href="https://github.com/WebAssembly/component-model/blob/main/design/mvp/WIT.md#handles">upstream component model specification</a>.</p>
</blockquote>
<h3 id="flags"><a class="header" href="#flags">Flags</a></h3>
<p>A <code>flags</code> type is a set of named booleans.  In an instance of the type, each flag will be either <code>true</code> or <code>false</code>.</p>
<pre><code class="language-treesitter">&lt;span class='hljs-keyword'&gt;flags&lt;/span&gt; allowed-methods &lt;span class='hljs-punctuation'&gt;{&lt;/span&gt;
    get&lt;span class='hljs-punctuation'&gt;,&lt;/span&gt;
    post&lt;span class='hljs-punctuation'&gt;,&lt;/span&gt;
    put&lt;span class='hljs-punctuation'&gt;,&lt;/span&gt;
    delete&lt;span class='hljs-punctuation'&gt;,&lt;/span&gt;
&lt;span class='hljs-punctuation'&gt;}&lt;/span&gt;
</code></pre>
<blockquote>
<p>A <code>flags</code> type is logically equivalent to a record type where each field is of type <code>bool</code>, but it is represented more efficiently (as a bitfield) at the binary level.</p>
</blockquote>
<h3 id="type-aliases"><a class="header" href="#type-aliases">Type aliases</a></h3>
<p>You can define a new named type using <code>type ... = ...</code>. This can be useful for giving shorter or more meaningful names to types:</p>
<pre><code class="language-treesitter">&lt;span class='hljs-keyword'&gt;type&lt;/span&gt; buffer &lt;span class='hljs-operator'&gt;=&lt;/span&gt; &lt;span class='hljs-type'&gt;list&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;&amp;lt;&lt;/span&gt;&lt;span class='hljs-type'&gt;u8&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;&amp;gt;&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;
&lt;span class='hljs-keyword'&gt;type&lt;/span&gt; http-&lt;span class='hljs-type'&gt;result&lt;/span&gt; &lt;span class='hljs-operator'&gt;=&lt;/span&gt; &lt;span class='hljs-type'&gt;result&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;&amp;lt;&lt;/span&gt;http-response&lt;span class='hljs-punctuation'&gt;,&lt;/span&gt; http-error&lt;span class='hljs-punctuation'&gt;&amp;gt;&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;
</code></pre>
<h2 id="functions"><a class="header" href="#functions">Functions</a></h2>
<p>A function is defined by a name and a function type. Like in record fields, the name is separated from the type by a colon:</p>
<pre><code class="language-treesitter">do-nothing&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-keyword'&gt;func&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;(&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;)&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;
</code></pre>
<p>The function type is the word <code>func</code>, followed by a parenthesised, comma-separated list of parameters (names and types). If the function returns a value, this is expressed as an arrow symbol (<code>-&gt;</code>) followed by the return type:</p>
<pre><code class="language-treesitter">&lt;span class='hljs-comment'&gt;// This function does not return a value&lt;/span&gt;
print&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-keyword'&gt;func&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;(&lt;/span&gt;message&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-type'&gt;string&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;)&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;

&lt;span class='hljs-comment'&gt;// These functions return values&lt;/span&gt;
add&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-keyword'&gt;func&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;(&lt;/span&gt;a&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-type'&gt;u64&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;,&lt;/span&gt; b&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-type'&gt;u64&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;)&lt;/span&gt; &lt;span class='hljs-punctuation'&gt;-&amp;gt;&lt;/span&gt; &lt;span class='hljs-type'&gt;u64&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;
lookup&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-keyword'&gt;func&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;(&lt;/span&gt;store&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; kv-store&lt;span class='hljs-punctuation'&gt;,&lt;/span&gt; key&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-type'&gt;string&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;)&lt;/span&gt; &lt;span class='hljs-punctuation'&gt;-&amp;gt;&lt;/span&gt; &lt;span class='hljs-type'&gt;option&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;&amp;lt;&lt;/span&gt;&lt;span class='hljs-type'&gt;string&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;&amp;gt;&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;
</code></pre>
<p>A function can have multiple return values. In this case the return values must be named, similar to the parameter list. All return values must be populated (in the same way as tuple or record fields).</p>
<pre><code class="language-treesitter">get-customers-paged&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-keyword'&gt;func&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;(&lt;/span&gt;cont&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; continuation-token&lt;span class='hljs-punctuation'&gt;)&lt;/span&gt; &lt;span class='hljs-punctuation'&gt;-&amp;gt;&lt;/span&gt; &lt;span class='hljs-punctuation'&gt;(&lt;/span&gt;customers&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-type'&gt;list&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;&amp;lt;&lt;/span&gt;customer&lt;span class='hljs-punctuation'&gt;&amp;gt;&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;,&lt;/span&gt; cont&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; continuation-token&lt;span class='hljs-punctuation'&gt;)&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;
</code></pre>
<p>A function can be declared as part of an <a href="design/wit.html#interfaces">interface</a>, or can be declared as an import or export in a <a href="design/wit.html#worlds">world</a>.</p>
<h2 id="interfaces-1"><a class="header" href="#interfaces-1">Interfaces</a></h2>
<p>An interface is a named set of types and functions, enclosed in braces and introduced with the <code>interface</code> keyword:</p>
<pre><code class="language-treesitter">&lt;span class='hljs-keyword'&gt;interface&lt;/span&gt; canvas &lt;span class='hljs-punctuation'&gt;{&lt;/span&gt;
    &lt;span class='hljs-keyword'&gt;type&lt;/span&gt; &lt;span class='hljs-type'&gt;canvas-id&lt;/span&gt; &lt;span class='hljs-operator'&gt;=&lt;/span&gt; &lt;span class='hljs-type'&gt;u64&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;

    &lt;span class='hljs-keyword'&gt;record&lt;/span&gt; &lt;span class='hljs-type'&gt;point&lt;/span&gt; &lt;span class='hljs-punctuation'&gt;{&lt;/span&gt;
        &lt;span class='hljs-variable'&gt;x&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-type'&gt;u32&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;,&lt;/span&gt;
        &lt;span class='hljs-variable'&gt;y&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-type'&gt;u32&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;,&lt;/span&gt;
    &lt;span class='hljs-punctuation'&gt;}&lt;/span&gt;

    &lt;span class='hljs-title function_'&gt;draw-line&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-keyword'&gt;func&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;(&lt;/span&gt;&lt;span class='hljs-variable'&gt;canvas&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-type'&gt;canvas-id&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;,&lt;/span&gt; &lt;span class='hljs-variable'&gt;from&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-type'&gt;point&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;,&lt;/span&gt; &lt;span class='hljs-variable'&gt;to&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-type'&gt;point&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;)&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;
&lt;span class='hljs-punctuation'&gt;}&lt;/span&gt;
</code></pre>
<p>Notice that items in an interface are <em>not</em> comma-separated.</p>
<h3 id="using-definitions-from-elsewhere"><a class="header" href="#using-definitions-from-elsewhere">Using definitions from elsewhere</a></h3>
<p>An interface can reuse types declared in another interface via a <code>use</code> directive. The <code>use</code> directive must give the interface where the types are declared, then a dot, then a braced list of the types to be reused. The interface can then refer to the types named in the <code>use</code>.</p>
<pre><code class="language-treesitter">&lt;span class='hljs-keyword'&gt;interface&lt;/span&gt; types &lt;span class='hljs-punctuation'&gt;{&lt;/span&gt;
    &lt;span class='hljs-keyword'&gt;type&lt;/span&gt; &lt;span class='hljs-type'&gt;dimension&lt;/span&gt; &lt;span class='hljs-operator'&gt;=&lt;/span&gt; &lt;span class='hljs-type'&gt;u32&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;
    &lt;span class='hljs-keyword'&gt;record&lt;/span&gt; &lt;span class='hljs-type'&gt;point&lt;/span&gt; &lt;span class='hljs-punctuation'&gt;{&lt;/span&gt;
        &lt;span class='hljs-variable'&gt;x&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-type'&gt;dimension&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;,&lt;/span&gt;
        &lt;span class='hljs-variable'&gt;y&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-type'&gt;dimension&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;,&lt;/span&gt;
    &lt;span class='hljs-punctuation'&gt;}&lt;/span&gt;
&lt;span class='hljs-punctuation'&gt;}&lt;/span&gt;

&lt;span class='hljs-keyword'&gt;interface&lt;/span&gt; canvas &lt;span class='hljs-punctuation'&gt;{&lt;/span&gt;
    &lt;span class='hljs-keyword'&gt;use&lt;/span&gt; types&lt;span class='hljs-punctuation'&gt;.&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;{&lt;/span&gt;dimension&lt;span class='hljs-punctuation'&gt;,&lt;/span&gt; point&lt;span class='hljs-punctuation'&gt;}&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;
    &lt;span class='hljs-keyword'&gt;type&lt;/span&gt; &lt;span class='hljs-type'&gt;canvas-id&lt;/span&gt; &lt;span class='hljs-operator'&gt;=&lt;/span&gt; &lt;span class='hljs-type'&gt;u64&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;
    &lt;span class='hljs-title function_'&gt;draw-line&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-keyword'&gt;func&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;(&lt;/span&gt;&lt;span class='hljs-variable'&gt;canvas&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-type'&gt;canvas-id&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;,&lt;/span&gt; &lt;span class='hljs-variable'&gt;from&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-type'&gt;point&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;,&lt;/span&gt; &lt;span class='hljs-variable'&gt;to&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-type'&gt;point&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;,&lt;/span&gt; &lt;span class='hljs-variable'&gt;thickness&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-type'&gt;dimension&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;)&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;
&lt;span class='hljs-punctuation'&gt;}&lt;/span&gt;
</code></pre>
<blockquote>
<p>Even if you are only using one type, it must still be enclosed in braces. For example, <code>use types.{dimension}</code> is legal but <code>use types.dimension</code> is not.</p>
</blockquote>
<p>This works across files as long as the files are in the same package (effectively, in the same directory). For information about using definitions from other packages, see <a href="https://github.com/WebAssembly/component-model/blob/main/design/mvp/WIT.md#interfaces-worlds-and-use">the specification</a>.</p>
<h2 id="worlds"><a class="header" href="#worlds">Worlds</a></h2>
<p>A world describes a set of imports and exports, enclosed in braces and introduced with the <code>world</code> keyword. Roughly, a world describes the contract of a component. Exports are provided by the component, and define what consumers of the component may call; imports are things the component may call. The imports and exports may be interfaces or individual functions.</p>
<pre><code class="language-treesitter">&lt;span class='hljs-keyword'&gt;interface&lt;/span&gt; printer &lt;span class='hljs-punctuation'&gt;{&lt;/span&gt;
    &lt;span class='hljs-title function_'&gt;print&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-keyword'&gt;func&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;(&lt;/span&gt;&lt;span class='hljs-variable'&gt;text&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-type'&gt;string&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;)&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;
&lt;span class='hljs-punctuation'&gt;}&lt;/span&gt;

&lt;span class='hljs-keyword'&gt;interface&lt;/span&gt; error-reporter &lt;span class='hljs-punctuation'&gt;{&lt;/span&gt;
    &lt;span class='hljs-title function_'&gt;report-error&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-keyword'&gt;func&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;(&lt;/span&gt;&lt;span class='hljs-variable'&gt;error-message&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-type'&gt;string&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;)&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;
&lt;span class='hljs-punctuation'&gt;}&lt;/span&gt;

&lt;span class='hljs-keyword'&gt;world&lt;/span&gt; multi-function-device &lt;span class='hljs-punctuation'&gt;{&lt;/span&gt;
    &lt;span class='hljs-comment'&gt;// The component implements the `printer` interface&lt;/span&gt;
    &lt;span class='hljs-keyword'&gt;export&lt;/span&gt; printer&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;

    &lt;span class='hljs-comment'&gt;// The component implements the `scan` function&lt;/span&gt;
    &lt;span class='hljs-keyword'&gt;export&lt;/span&gt; &lt;span class='hljs-title function_'&gt;scan&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-keyword'&gt;func&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;(&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;)&lt;/span&gt; &lt;span class='hljs-punctuation'&gt;-&amp;gt;&lt;/span&gt; &lt;span class='hljs-type'&gt;list&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;&amp;lt;&lt;/span&gt;&lt;span class='hljs-type'&gt;u8&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;&amp;gt;&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;

    &lt;span class='hljs-comment'&gt;// The component needs to be supplied with an `error-reporter`&lt;/span&gt;
    &lt;span class='hljs-keyword'&gt;import&lt;/span&gt; error-reporter&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;
&lt;span class='hljs-punctuation'&gt;}&lt;/span&gt;
</code></pre>
<h3 id="interfaces-from-other-packages"><a class="header" href="#interfaces-from-other-packages">Interfaces from other packages</a></h3>
<p>You can import and export interfaces defined in other packages. This can be done using <code>package/name</code> syntax:</p>
<pre><code class="language-treesitter">&lt;span class='hljs-keyword'&gt;world&lt;/span&gt; http-proxy &lt;span class='hljs-punctuation'&gt;{&lt;/span&gt;
    &lt;span class='hljs-keyword'&gt;export&lt;/span&gt; wasi&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt;http&lt;span class='hljs-punctuation'&gt;/&lt;/span&gt;incoming-handler&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;
    &lt;span class='hljs-keyword'&gt;import&lt;/span&gt; wasi&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt;http&lt;span class='hljs-punctuation'&gt;/&lt;/span&gt;outgoing-handler&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;
&lt;span class='hljs-punctuation'&gt;}&lt;/span&gt;
</code></pre>
<blockquote>
<p>As this example shows, import and export apply at the interface level, not the package level. You can import one interface defined in a package, while exporting another interface defined in the same package. Packages group definitions; they don't represent behaviour.</p>
</blockquote>
<p>WIT does not define how packages are resolved - different tools may resolve them in different ways.</p>
<h3 id="inline-interfaces"><a class="header" href="#inline-interfaces">Inline interfaces</a></h3>
<p>Interfaces can be declared inline in a world:</p>
<pre><code class="language-treesitter">&lt;span class='hljs-keyword'&gt;world&lt;/span&gt; toy &lt;span class='hljs-punctuation'&gt;{&lt;/span&gt;
    &lt;span class='hljs-keyword'&gt;export&lt;/span&gt; example&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-keyword'&gt;interface&lt;/span&gt; &lt;span class='hljs-punctuation'&gt;{&lt;/span&gt;
        &lt;span class='hljs-title function_'&gt;do-nothing&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-keyword'&gt;func&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;(&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;)&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;
    &lt;span class='hljs-punctuation'&gt;}&lt;/span&gt;
&lt;span class='hljs-punctuation'&gt;}&lt;/span&gt;
</code></pre>
<h3 id="including-other-worlds"><a class="header" href="#including-other-worlds">Including other worlds</a></h3>
<p>You can <code>include</code> another world. This causes your world to export all that world's exports, and import all that world's imports.</p>
<pre><code class="language-treesitter">&lt;span class='hljs-keyword'&gt;world&lt;/span&gt; glow-in-the-dark-multi-function-device &lt;span class='hljs-punctuation'&gt;{&lt;/span&gt;
    &lt;span class='hljs-comment'&gt;// The component provides all the same exports, and depends on&lt;/span&gt;
    &lt;span class='hljs-comment'&gt;// all the same imports, as a `multi-function-device`...&lt;/span&gt;
    &lt;span class='hljs-keyword'&gt;include&lt;/span&gt; multi-function-device&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;

    &lt;span class='hljs-comment'&gt;// ...but also exports a function to make it glow in the dark&lt;/span&gt;
    &lt;span class='hljs-keyword'&gt;export&lt;/span&gt; &lt;span class='hljs-title function_'&gt;glow&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-keyword'&gt;func&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;(&lt;/span&gt;&lt;span class='hljs-variable'&gt;brightness&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt; &lt;span class='hljs-type'&gt;u8&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;)&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;
&lt;span class='hljs-punctuation'&gt;}&lt;/span&gt;
</code></pre>
<p>As with <code>use</code> directives, you can <code>include</code> worlds from other packages.</p>
<h2 id="packages"><a class="header" href="#packages">Packages</a></h2>
<p>A package is a set of interfaces and worlds, potentially defined across multiple files. To declare a package, use the <code>package</code> directive to specify the package ID. This must include a namespace and name, separated by a colon, and may optionally include a semver-compliant version:</p>
<pre><code class="language-treesitter">&lt;span class='hljs-keyword'&gt;package&lt;/span&gt; documentation&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt;example&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;
&lt;span class='hljs-keyword'&gt;package&lt;/span&gt; documentation&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt;example&lt;span class='hljs-punctuation'&gt;@&lt;/span&gt;&lt;span class='hljs-string'&gt;1.0.1&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;
</code></pre>
<p>If a package spans multiple files, only one file needs to contain a package declaration (but if multiple files contain declarations then they must all be the same). All files must have the <code>.wit</code> extension and must be in the same directory. For example, the following <code>documentation:http</code> package is spread across four files:</p>
<pre><code class="language-treesitter">&lt;span class='hljs-comment'&gt;// types.wit&lt;/span&gt;
&lt;span class='hljs-keyword'&gt;interface&lt;/span&gt; types &lt;span class='hljs-punctuation'&gt;{&lt;/span&gt;
    &lt;span class='hljs-keyword'&gt;record&lt;/span&gt; &lt;span class='hljs-type'&gt;request&lt;/span&gt; &lt;span class='hljs-punctuation'&gt;{&lt;/span&gt; &lt;span class='hljs-comment'&gt;/* ... */&lt;/span&gt; &lt;span class='hljs-punctuation'&gt;}&lt;/span&gt;
    &lt;span class='hljs-keyword'&gt;record&lt;/span&gt; &lt;span class='hljs-type'&gt;response&lt;/span&gt; &lt;span class='hljs-punctuation'&gt;{&lt;/span&gt; &lt;span class='hljs-comment'&gt;/* ... */&lt;/span&gt; &lt;span class='hljs-punctuation'&gt;}&lt;/span&gt;
&lt;span class='hljs-punctuation'&gt;}&lt;/span&gt;

&lt;span class='hljs-comment'&gt;// incoming.wit&lt;/span&gt;
&lt;span class='hljs-keyword'&gt;interface&lt;/span&gt; incoming-handler &lt;span class='hljs-punctuation'&gt;{&lt;/span&gt;
    &lt;span class='hljs-keyword'&gt;use&lt;/span&gt; types&lt;span class='hljs-punctuation'&gt;.&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;{&lt;/span&gt;request&lt;span class='hljs-punctuation'&gt;,&lt;/span&gt; response&lt;span class='hljs-punctuation'&gt;}&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;
    &lt;span class='hljs-comment'&gt;// ...&lt;/span&gt;
&lt;span class='hljs-punctuation'&gt;}&lt;/span&gt;

&lt;span class='hljs-comment'&gt;// outgoing.wit&lt;/span&gt;
&lt;span class='hljs-keyword'&gt;interface&lt;/span&gt; outgoing-handler &lt;span class='hljs-punctuation'&gt;{&lt;/span&gt;
    &lt;span class='hljs-keyword'&gt;use&lt;/span&gt; types&lt;span class='hljs-punctuation'&gt;.&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;{&lt;/span&gt;request&lt;span class='hljs-punctuation'&gt;,&lt;/span&gt; response&lt;span class='hljs-punctuation'&gt;}&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;
    &lt;span class='hljs-comment'&gt;// ...&lt;/span&gt;
&lt;span class='hljs-punctuation'&gt;}&lt;/span&gt;

&lt;span class='hljs-comment'&gt;// http.wit&lt;/span&gt;
&lt;span class='hljs-keyword'&gt;package&lt;/span&gt; documentation&lt;span class='hljs-punctuation'&gt;:&lt;/span&gt;http&lt;span class='hljs-punctuation'&gt;@&lt;/span&gt;&lt;span class='hljs-string'&gt;1.0.0&lt;/span&gt;&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;

&lt;span class='hljs-keyword'&gt;world&lt;/span&gt; proxy &lt;span class='hljs-punctuation'&gt;{&lt;/span&gt;
    &lt;span class='hljs-keyword'&gt;export&lt;/span&gt; incoming-handler&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;
    &lt;span class='hljs-keyword'&gt;import&lt;/span&gt; outgoing-handler&lt;span class='hljs-punctuation'&gt;;&lt;/span&gt;
&lt;span class='hljs-punctuation'&gt;}&lt;/span&gt;
</code></pre>
<blockquote>
<p>For a more formal definition of the WIT language, take a look at the <a href="https://github.com/WebAssembly/component-model/blob/main/design/mvp/WIT.md">WIT specification</a>.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="wit-packages"><a class="header" href="#wit-packages">WIT Packages</a></h1>
<p>A <strong>WIT package</strong> is a set of one or more <a href="design/./wit.html">WIT (Wasm Interface Type)</a> files containing a related set of interfaces and worlds. WIT is an IDL (interface definition language) for the Component Model. Packages provide a way for worlds and interfaces to refer to each other, and thus for an ecosystem of components to share common definitions.</p>
<p>A WIT package is not a <a href="design/./worlds.html">world</a>. It's a way of grouping related interfaces and worlds together for ease of discovery and reference, more like a namespace.</p>
<ul>
<li>The WebAssembly System Interface (WASI) defines a number of packages, including one named <code>wasi:clocks</code>. Our HTTP proxy world could import the <code>wall-clock</code> interface from the <code>wasi:clocks</code> package, rather than having to define a custom clock interface.</li>
</ul>
<blockquote>
<p>For a more formal definition of what a WIT package is, take a look at the <a href="https://github.com/WebAssembly/component-model/blob/main/design/mvp/WIT.md">WIT specification</a>.</p>
</blockquote>
<div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="wasm-language-support"><a class="header" href="#wasm-language-support">Wasm Language Support</a></h1>
<p>WebAssembly can be targeted by the majority of top programming
languages; however, the level of
support varies. This document details the subset of languages that target WASI and support
components.</p>
<blockquote>
<p>This is a living document, so if you are aware of advancements in a toolchain, please do
not hesitate to <a href="https://github.com/bytecodealliance/component-docs/blob/main/CONTRIBUTING.md">contribute documentation</a>. You can find more information about the development of support for specific languages in the <a href="https://github.com/bytecodealliance/governance/blob/main/SIGs/SIG-guest-languages/proposal.md">Guest Languages Special Interest Group Proposal</a> document.</p>
</blockquote>
<p>One of the benefits of components is their portability across host runtimes. The runtime only needs
to know what world the component is targeting in order to import or execute the component. This
language guide hopes to demonstrate that with a prevailing <code>example</code> world defined in
<a href="https://github.com/bytecodealliance/component-docs/blob/main/component-model/examples/example-host/add.wit"><code>examples/example-host/add.wit</code></a>. Furthermore, an example host that understands the <code>example</code>
world has been provided in <a href="https://github.com/bytecodealliance/component-docs/blob/main/component-model/examples/example-host/README.md"><code>examples/example-host</code></a> for running components. Each
toolchain section walks through creating a component of this world, which can be run either in the
example host or from an application of that toolchain. This aims to provide a full story for using
components within and among toolchains.</p>
<p>Each section covers how to build and
run components for a given toolchain:</p>
<ul>
<li><a href="language-support.html#wasm-language-support">Wasm Language Support</a>
<ul>
<li><a href="language-support.html#language-agnostic-tooling">Language Agnostic Tooling</a>
<ul>
<li><a href="language-support.html#building-a-component-with-wasm-tools">Building a Component with <code>wasm-tools</code></a></li>
<li><a href="language-support.html#running-a-component-with-wasmtime">Running a Component with Wasmtime</a></li>
</ul>
</li>
<li><a href="./language-support/c.html">C/C++ Tooling</a>
<ul>
<li><a href="./language-support/c.html#building-a-component-with-wit-bindgen-and-wasm-tools">Building a Component with <code>wit-bindgen</code> and <code>wasm-tools</code></a></li>
<li><a href="./language-support/c.html#running-a-component-from-cc-applications">Running a Component from C/C++ Applications</a></li>
</ul>
</li>
<li><a href="./language-support/csharp.html">C# Tooling</a></li>
<li><a href="./language-support/go.html">Go Tooling</a></li>
<li><a href="./language-support/javascript.html">JavaScript Tooling</a>
<ul>
<li><a href="./language-support/javascript.html#building-a-component-with-jco">Building a Component with <code>jco</code></a></li>
<li><a href="./language-support/javascript.html#running-a-component-from-javascript-applications">Running a Component from JavaScript Applications</a></li>
</ul>
</li>
<li><a href="./language-support/python.html">Python Tooling</a>
<ul>
<li><a href="./language-support/python.html#building-a-component-with-componentize-py">Building a Component with <code>componentize-py</code></a></li>
<li><a href="./language-support/python.html#running-components-from-python-applications">Running components from Python Applications</a></li>
</ul>
</li>
<li><a href="./language-support/rust.html">Rust Tooling</a>
<ul>
<li><a href="./language-support/rust.html#building-a-component-with-cargo-component">Building a Component with <code>cargo component</code></a></li>
<li><a href="./language-support/rust.html#running-a-component-from-rust-appliacations">Running a Component from Rust Applications</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="language-agnostic-tooling"><a class="header" href="#language-agnostic-tooling">Language Agnostic Tooling</a></h2>
<h3 id="building-a-component-with-wasm-tools"><a class="header" href="#building-a-component-with-wasm-tools">Building a Component with <code>wasm-tools</code></a></h3>
<p><a href="https://github.com/bytecodealliance/wasm-tools"><code>wasm-tools</code></a> provides a suite of subcommands for
working with WebAssembly modules and components.</p>
<p><code>wasm-tools</code> can be used to create a component from WebAssembly Text (WAT). This walks through creating a component from WAT that implements the <a href="https://github.com/bytecodealliance/component-docs/blob/main/component-model/examples/example-host/add.wit"><code>example</code> world</a> and simply adds two numbers.</p>
<ol>
<li>
<p>Install <a href="https://github.com/bytecodealliance/wasm-tools/tree/main#installation"><code>wasm-tools</code></a>, a
tool for low-level manipulation of Wasm modules and components.</p>
</li>
<li>
<p>The <code>add</code> function is defined inside the following <code>example</code> world:</p>
<pre><code class="language-wit">package example:component;

world example {
    export add: func(x: s32, y: s32) -&gt; s32;
}
</code></pre>
</li>
<li>
<p>Define an <code>add</code> core module in WAT that exports an <code>add</code> function that adds two parameters:</p>
<pre><code class="language-wat">(module
  (func $add (param $lhs i32) (param $rhs i32) (result i32)
      local.get $lhs
      local.get $rhs
      i32.add)
  (export "add" (func $add))
)
</code></pre>
</li>
<li>
<p>Use <code>wasm-tools</code> to create a component from the core module, first embedding component metadata
inside the core module and then encoding the WAT to a Wasm binary.</p>
<pre><code class="language-sh">$ wasm-tools component embed add.wit add.wat -o add.wasm
$ wasm-tools component new add.wasm -o add.component.wasm
</code></pre>
</li>
</ol>
<h3 id="running-a-component-with-wasmtime"><a class="header" href="#running-a-component-with-wasmtime">Running a Component with Wasmtime</a></h3>
<p>You can "run" a component by calling one of its exports. Hosts and runtimes often only support
running components with certain exports. The <a href="https://github.com/bytecodealliance/wasmtime"><code>wasmtime</code></a> CLI can only run "command" components, so in
order to run the <code>add</code> function above, it first must be composed with a primary "command" component
that calls it. See <a href="./creating-and-consuming/running.html">documentation on running components</a> for
more details.</p>
<div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h2 id="cc-tooling"><a class="header" href="#cc-tooling">C/C++ Tooling</a></h2>
<h3 id="building-a-component-with-wit-bindgen-and-wasm-tools"><a class="header" href="#building-a-component-with-wit-bindgen-and-wasm-tools">Building a Component with <code>wit-bindgen</code> and <code>wasm-tools</code></a></h3>
<p><a href="https://github.com/bytecodealliance/wit-bindgen"><code>wit-bindgen</code></a> is a tool to generate guest language bindings from a given <code>.wit</code> file. Although it is less integrated into language toolchains than other tools such as <code>cargo-component</code>, it can currently generate source-level bindings for <code>Rust</code>, <code>C</code>, <code>Java (TeaVM)</code>, and <code>TinyGo</code>, with the ability for more language generators to be added in the future.</p>
<p><code>wit-bindgen</code> can be used to generate C applications that can be compiled directly to Wasm modules using <code>clang</code> with a <code>wasm32-wasi</code> target.</p>
<p>First, install the CLI for <a href="https://github.com/bytecodealliance/wit-bindgen#cli-installation"><code>wit-bindgen</code></a>, <a href="https://github.com/bytecodealliance/wasm-tools"><code>wasm-tools</code></a>, and the <a href="https://github.com/webassembly/wasi-sdk"><code>WASI SDK</code></a>.</p>
<p>The WASI SDK will install a local version of <code>clang</code> configured with a wasi-sysroot. Follow <a href="https://github.com/WebAssembly/wasi-sdk#use">these instructions</a> to configure it for use. Note that you can also use your installed system or emscripten <code>clang</code> by building with <code>--target=wasm32-wasi</code> but you will need some artifacts from WASI SDK to enable and link that build target (more information is available in WASI SDK's docs).</p>
<p>Start by generating a C skeleton from <code>wit-bindgen</code> using the <a href="language-support/../../examples/example-host/add.wit">sample <code>add.wit</code> file</a>:</p>
<pre><code class="language-sh">&gt;wit-bindgen c add.wit
Generating "example.c"
Generating "example.h"
Generating "example_component_type.o"
</code></pre>
<p>This has generated several files - an <code>example.h</code> (based on the name of your <code>world</code>) with the prototype of the <code>add</code> function - <code>int32_t example_add(int32_t x, int32_t y);</code>, as well as some generated code in <code>example.c</code> that interfaces with the component model ABI to call your function. Additionally, <code>example_component_type.o</code> contains object code referenced in <code>example.c</code> from an <code>extern</code> that must be linked via clang.</p>
<p>Next, create an <code>add.c</code> that implements your function defined in <code>example.h</code>:</p>
<pre><code class="language-c">#include "example.h"

int32_t example_add(int32_t x, int32_t y)
{
	return x + y;
}
</code></pre>
<p>Now, you can compile the function into a Wasm module via clang:</p>
<pre><code class="language-sh">clang add.c example.c example_component_type.o -o add-core.wasm -mexec-model=reactor
</code></pre>
<blockquote>
<p>Use the <code>clang</code> included in the WASI SDK installation, for example at <code>&lt;WASI_SDK_PATH&gt;/bin/clang</code>.</p>
</blockquote>
<p>Next, you need to transform the module into a component.  For this example, you can use <code>wasm-tools component new</code>:</p>
<pre><code class="language-sh">wasm-tools component new ./add-core.wasm -o add-component.wasm
</code></pre>
<p>Do note this will fail if your code references any WASI APIs that must be imported. This requires an additional step as the WASI SDK still references <code>wasi_snapshot_preview1</code> APIs that are not compatible directly with components.</p>
<p>For example, modifying the above to reference <code>printf()</code> would compile:</p>
<pre><code class="language-c">#include "example.h"
#include &lt;stdio.h&gt;

int32_t example_add(int32_t x, int32_t y)
{
	int32_t result = x + y;
	printf("%d", result);
	return result;
}
</code></pre>
<p>However, the module would fail to transform to a component:</p>
<pre><code class="language-sh">&gt;wasm-tools component new ./add-core.wasm -o add-component.wasm
error: failed to encode a component from module

Caused by:
    0: failed to decode world from module
    1: module was not valid
    2: module requires an import interface named `wasi_snapshot_preview1`  
</code></pre>
<p>Install the appropriate reactor adapter module <a href="https://github.com/bytecodealliance/wit-bindgen#creating-components-wasi">as documented here</a> - you can either get the linked release of <code>wasi_snapshot_preview1.reactor.wasm</code> and rename it to <code>wasi_snapshot_preview1.wasm</code>, or build it directly from source in <code>wasmtime</code> following the <a href="https://github.com/bytecodealliance/wasmtime/tree/main/crates/wasi-preview1-component-adapter">instructions here</a> (make sure you <code>git submodule update --init</code> first).</p>
<p>Now, you can adapt preview1 to preview2 to build a component:</p>
<pre><code class="language-sh">wasm-tools component new add-core.wasm --adapt wasi_snapshot_preview1.wasm -o add-component.wasm
</code></pre>
<p>Finally, you can inspect the embedded wit to see your component (including any WASI imports if necessary):</p>
<pre><code class="language-sh">&gt;wasm-tools component wit add-component.wasm
package root:component;

world root {
  import wasi:io/error@0.2.0;
  import wasi:io/streams@0.2.0;
  import wasi:cli/stdin@0.2.0;
  import wasi:cli/stdout@0.2.0;
  import wasi:cli/stderr@0.2.0;
  import wasi:cli/terminal-input@0.2.0;
  import wasi:cli/terminal-output@0.2.0;
  import wasi:cli/terminal-stdin@0.2.0;
  import wasi:cli/terminal-stdout@0.2.0;
  import wasi:cli/terminal-stderr@0.2.0;
  import wasi:clocks/wall-clock@0.2.0;
  import wasi:filesystem/types@0.2.0;
  import wasi:filesystem/preopens@0.2.0;

  export add: func(x: s32, y: s32) -&gt; s32;
}
</code></pre>
<h3 id="running-a-component-from-cc-applications"><a class="header" href="#running-a-component-from-cc-applications">Running a Component from C/C++ Applications</a></h3>
<p>It is not yet possible to run a Component using the <code>wasmtime</code> <code>c-api</code> - <a href="https://github.com/bytecodealliance/wasmtime/issues/6987">see this issue</a>. The c-api is preferred to trying to directly use the Rust crate in C++.</p>
<p>However, C/C++ language guest components can be composed with components written in any other language and run by their toolchains, or even composed with a C language command component and run via the <code>wasmtime</code> CLI or any other host.</p>
<p>See the <a href="language-support/../language-support/rust.html#running-a-component-from-rust-applications">Rust Tooling guide</a> for instructions on how to run this component from the Rust <code>example-host</code>.</p>
<div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="c-tooling"><a class="header" href="#c-tooling">C# Tooling</a></h1>
<h2 id="building-a-component-with-componentize-dotnet"><a class="header" href="#building-a-component-with-componentize-dotnet">Building a Component with <code>componentize-dotnet</code></a></h2>
<p><a href="https://github.com/bytecodealliance/componentize-dotnet">componentize-dotnet</a> makes it easy to
compile your code to WebAssembly components using a single tool. This Bytecode Alliance project is a
NuGet package that can be used to create a fully AOT-compiled component, giving .NET developers a
component experience comparable to those in Rust and TinyGo.</p>
<p>componentize-dotnet serves as a one-stop shop for .NET developers, wrapping several tools into one:</p>
<ul>
<li><a href="https://github.com/dotnet/runtimelab/tree/feature/NativeAOT-LLVM">NativeAOT-LLVM</a> (compilation)</li>
<li><a href="https://github.com/bytecodealliance/wit-bindgen">wit-bindgen</a> (WIT imports and exports)</li>
<li><a href="https://github.com/bytecodealliance/wasm-tools">wasm-tools</a> (component conversion)</li>
<li><a href="https://github.com/WebAssembly/wasi-sdk">WASI SDK</a> (SDK used by NativeAOT-LLVM)</li>
</ul>
<p>First, install the .NET SDK. For this walkthrough, well use the <a href="https://dotnet.microsoft.com/en-us/download/dotnet/9.0">.NET 9 SDK RC
1</a>. You should also have
<a href="https://wasmtime.dev/">wasmtime</a> installed so you can run the binary that you produce.</p>
<p>Once you have the .NET SDK installed, create a new project:</p>
<pre><code class="language-sh">dotnet new classlib -o adder
cd adder
</code></pre>
<p>The <code>componentize-dotnet</code> package depends on the <code>NativeAOT-LLVM</code> package, which resides at the
dotnet-experimental package source, so you will need to make sure that NuGet is configured to refer
to experimental packages. You can create a project-scoped NuGet configuration by running:</p>
<pre><code class="language-sh">dotnet new nugetconfig
</code></pre>
<p>Edit your nuget.config file to look like this:</p>
<pre><code class="language-xml">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;configuration&gt;
 &lt;packageSources&gt;
    &lt;!--To inherit the global NuGet package sources remove the &lt;clear/&gt; line below --&gt;
    &lt;clear /&gt;
    &lt;add key="dotnet-experimental" value="https://pkgs.dev.azure.com/dnceng/public/_packaging/dotnet-experimental/nuget/v3/index.json" /&gt;
    &lt;add key="nuget" value="https://api.nuget.org/v3/index.json" /&gt;
 &lt;/packageSources&gt;
&lt;/configuration&gt;
</code></pre>
<p>Now back in the console well add the <code>BytecodeAlliance.Componentize.DotNet.Wasm.SDK</code> package:</p>
<pre><code class="language-sh">dotnet add package BytecodeAlliance.Componentize.DotNet.Wasm.SDK --prerelease
</code></pre>
<p>In the .csproj project file, add the following to the <code>&lt;PropertyGroup&gt;</code>:</p>
<pre><code class="language-xml">&lt;RuntimeIdentifier&gt;wasi-wasm&lt;/RuntimeIdentifier&gt;
&lt;UseAppHost&gt;false&lt;/UseAppHost&gt;
&lt;PublishTrimmed&gt;true&lt;/PublishTrimmed&gt;
&lt;InvariantGlobalization&gt;true&lt;/InvariantGlobalization&gt;
&lt;SelfContained&gt;true&lt;/SelfContained&gt;
</code></pre>
<p>Next, create or download the WIT world you would like to target. For this example we will use an
<a href="https://github.com/bytecodealliance/component-docs/tree/main/component-model/examples/example-host/add.wit"><code>example</code>
world</a>
with an <code>add</code> function:</p>
<pre><code class="language-wit">package example:component;

world example {
    export add: func(x: s32, y: s32) -&gt; s32;
}
</code></pre>
<p>In the .csproj project file, add a new <code>&lt;ItemGroup&gt;</code>:</p>
<pre><code class="language-xml">&lt;ItemGroup&gt;
    &lt;Wit Update="add.wit" World="example" /&gt;
&lt;/ItemGroup&gt;
</code></pre>
<p>If you try to build the project with <code>dotnet build</code>, you'll get an error like "The name
'ExampleWorldImpl' does not exist in the current context". This is because you've said you'll
provide an implementation, but haven't yet done so. To fix this, add the following code to your
project:</p>
<pre><code class="language-csharp">namespace ExampleWorld;

public class ExampleWorldImpl : IOperations
{
    public static int Add(int x, int y)
    {
        return x + y;
    }
}
</code></pre>
<p>If we build it:</p>
<pre><code class="language-sh">dotnet build
</code></pre>
<p>The component will be available at <code>bin/Debug/net9.0/wasi-wasm/native/adder.wasm</code>.</p>
<h2 id="building-a-component-that-exports-an-interface"><a class="header" href="#building-a-component-that-exports-an-interface">Building a component that exports an interface</a></h2>
<p>The previous example uses a WIT file that exports a function. However, to use your component from
another component, it must export an interface. That being said, you rarely find WIT that does not
contain an interface. (Most WITs you'll see in the wild do use interfaces; we've been simplifying by
exporting a function.) Let's expand our <code>example</code> world to export an interface rather than directly
export the function. We are also adding the <code>hostapp</code> world to our WIT file which we will implement
in <a href="language-support/csharp.html#building-a-component-that-imports-an-interface">the next section</a> to demonstrate how to build a
component that <em>imports</em> an interface.</p>
<pre><code class="language-wit">// add.wit
package example:component;

interface add {
    add: func(x: u32, y: u32) -&gt; u32;
}

world example {
    export add;
}

world hostapp {
    import add;
}
</code></pre>
<p>If you peek at the bindings, you'll notice that we now implement a class for the <code>add</code> interface
rather than for the <code>example</code> world. This is a consistent pattern. As you export more interfaces
from your world, you implement more classes. Our add example gets the slight update of:</p>
<pre><code class="language-csharp">namespace ExampleWorld.wit.exports.example.component;

public class AddImpl : IAdd
{
    public static int Add(int x, int y)
    {
        return x + y;
    }
}
</code></pre>
<p>Once again, compile an application to a Wasm component using <code>dotnet build</code>:</p>
<pre><code class="language-sh">$ dotnet build
Restore complete (0.4s)
You are using a preview version of .NET. See: https://aka.ms/dotnet-support-policy
  adder succeeded (1.1s)  bin/Debug/net9.0/wasi-wasm/adder.dll

Build succeeded in 2.5s
</code></pre>
<p>The component will be available at <code>bin/Debug/net9.0/wasi-wasm/native/adder.wasm</code>.</p>
<h2 id="building-a-component-that-imports-an-interface"><a class="header" href="#building-a-component-that-imports-an-interface">Building a component that imports an interface</a></h2>
<p>So far, we've been dealing with library components. Now we will be creating a command component that
implements the <code>hostapp</code> world. This component will import the <code>add</code> interface that is exported from
our <code>adder</code> component and call the <code>add</code> function. We will later compose this command component with
the <code>adder</code> library component we just built.</p>
<p>Now we will be taking the <code>adder</code> component and executing it from another WebAssembly component.
<code>dotnet new console</code> creates a new project that creates an executable.</p>
<pre><code class="language-sh">dotnet new console -o host-app
cd host-app
</code></pre>
<p>The <code>componentize-dotnet</code> package depends on the <code>NativeAOT-LLVM</code> package, which resides at the
dotnet-experimental package source, so you will need to make sure that NuGet is configured to refer
to experimental packages. You can create a project-scoped NuGet configuration by running:</p>
<pre><code class="language-sh">dotnet new nugetconfig
</code></pre>
<p>Edit your nuget.config file to look like this:</p>
<pre><code class="language-xml">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;configuration&gt;
 &lt;packageSources&gt;
    &lt;!--To inherit the global NuGet package sources remove the &lt;clear/&gt; line below --&gt;
    &lt;clear /&gt;
    &lt;add key="dotnet-experimental" value="https://pkgs.dev.azure.com/dnceng/public/_packaging/dotnet-experimental/nuget/v3/index.json" /&gt;
    &lt;add key="nuget" value="https://api.nuget.org/v3/index.json" /&gt;
 &lt;/packageSources&gt;
&lt;/configuration&gt;
</code></pre>
<p>Now back in the console well add the <code>BytecodeAlliance.Componentize.DotNet.Wasm.SDK</code> package:</p>
<pre><code class="language-sh">dotnet add package BytecodeAlliance.Componentize.DotNet.Wasm.SDK --prerelease
</code></pre>
<p>In the .csproj project file, add the following to the <code>&lt;PropertyGroup&gt;</code>:</p>
<pre><code class="language-xml">&lt;RuntimeIdentifier&gt;wasi-wasm&lt;/RuntimeIdentifier&gt;
&lt;UseAppHost&gt;false&lt;/UseAppHost&gt;
&lt;PublishTrimmed&gt;true&lt;/PublishTrimmed&gt;
&lt;InvariantGlobalization&gt;true&lt;/InvariantGlobalization&gt;
&lt;SelfContained&gt;true&lt;/SelfContained&gt;
</code></pre>
<p>Copy the same WIT file as before into your project:</p>
<pre><code class="language-wit">// add.wit
package example:component;

interface add {
    add: func(x: u32, y: u32) -&gt; u32;
}

world example {
    export add;
}

world hostapp {
    import add;
}
</code></pre>
<p>Add it to your .csproj project file as a new <code>ItemGroup</code>:</p>
<pre><code class="language-xml">&lt;ItemGroup&gt;
    &lt;Wit Update="add.wit" World="hostapp" /&gt;
&lt;/ItemGroup&gt;
</code></pre>
<p>Notice how the <code>World</code> changed from <code>example</code> to <code>hostapp</code>. The previous examples focused on
implementing the class library for this WIT file - the <code>export</code> functions. Now we'll be focusing on
the executable side of the application - the <code>hostapp</code> world.</p>
<p>Modify <code>Program.cs</code> to look like this:</p>
<pre><code class="language-csharp">// Pull in all imports of the `hostapp` world, namely the `add` interface.
// example.component refers to the package name defined in the WIT file.
using HostappWorld.wit.imports.example.component;

var left = 1;
var right = 2;
var result = AddInterop.Add(left, right);
Console.WriteLine($"{left} + {right} = {result}");
</code></pre>
<p>Once again, compile your component with <code>dotnet build</code>:</p>
<pre><code class="language-sh">$ dotnet build
Restore complete (0.4s)
You are using a preview version of .NET. See: https://aka.ms/dotnet-support-policy
  host-app succeeded (1.1s)  bin/Debug/net9.0/wasi-wasm/host-app.dll

Build succeeded in 2.5s
</code></pre>
<p>At this point, you'll have two Webassembly components:</p>
<ol>
<li>A component that implements the <code>example</code> world.</li>
<li>A component that implements the <code>hostapp</code> world.</li>
</ol>
<p>Since the <code>host-app</code> component depends on the <code>add</code> function which is defined in the <code>example</code>
world, it needs to be composed the first component. You can compose your <code>host-app</code> component with
your <code>adder</code> component by running <a href="https://github.com/bytecodealliance/wac"><code>wac plug</code></a>:</p>
<pre><code class="language-sh">wac plug bin/Debug/net9.0/wasi-wasm/native/host-app.wasm --plug ../adder/bin/Debug/net9.0/wasi-wasm/native/adder.wasm -o main.wasm
</code></pre>
<p>Then you can run the composed component:</p>
<pre><code class="language-sh">wasmtime run main.wasm
1 + 2 = 3
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="go-tooling"><a class="header" href="#go-tooling">Go Tooling</a></h1>
<p>The <a href="https://tinygo.org/">TinyGo compiler</a> v0.34.0 and above has native support for the WebAssembly Component Model and WASI 0.2.0. This guide walks through building a component that implements <code>example</code> world defined in the <a href="language-support/../../examples/example-host/add.wit"><code>add.wit</code>
package</a>. The component will implement a simple add function.</p>
<h2 id="1-install-the-tools"><a class="header" href="#1-install-the-tools">1. Install the tools</a></h2>
<p>Follow the <a href="https://tinygo.org/getting-started/">TinyGo installation instructions</a> to install the TinyGo compiler. Additionally, install the <code>wasm-tools</code> CLI tool from the <a href="https://github.com/bytecodealliance/wasm-tools/releases">wasm-tools repository</a>.</p>
<p>To verify the installation, run the following commands:</p>
<pre><code class="language-console">$ tinygo version
tinygo version 0.34.0 ...
$ wasm-tools -V
wasm-tools 1.219.1 ...
</code></pre>
<p>Optional: Install the <code>wkg</code> CLI tool to resolve the imports in the WIT file. The <code>wkg</code> CLI is a part of the <a href="https://github.com/bytecodealliance/wasm-pkg-tools/releases">Wasm Component package manager</a></p>
<h2 id="2-determine-which-world-the-component-will-implement"><a class="header" href="#2-determine-which-world-the-component-will-implement">2. Determine which World the Component will Implement</a></h2>
<p>The <code>wasip2</code> target of TinyGo assumes that the component is targeting <code>wasi:cli/command@0.2.0</code> world so it requires the imports of <code>wasi:cli/imports@0.2.0</code>. We need to include them in the <code>add.wit</code>. Tools like <code>wkg</code> can be handy to build a complete WIT package by resolving the imports.</p>
<pre><code class="language-wit"># wit/add.wit
package docs:adder@0.1.0;
world adder {
  include wasi:cli/imports@0.2.0;
  export add: func(x: s32, y: s32) -&gt; s32;
}
</code></pre>
<p>Running the <code>wkg wit build</code> command will resolve the imports and generate the complete WIT file encoded as a Wasm component.</p>
<pre><code class="language-console">wkg wit build 
</code></pre>
<p>Or you can manually include the required imports in the <code>add.wit</code> file. Below is the minimal <code>add.wit</code> file that includes the required imports:</p>
<pre><code class="language-wit">package docs:adder@0.1.0;

world adder {
  import wasi:io/error@0.2.0;
  import wasi:io/streams@0.2.0;
  import wasi:cli/stdout@0.2.0;
  import wasi:random/random@0.2.0;

  export add: func(x: s32, y: s32) -&gt; s32;
}

package wasi:io@0.2.0 {
  interface error {
    resource error;
  }
  interface streams {
    use error.{error};

    resource output-stream {
      blocking-write-and-flush: func(contents: list&lt;u8&gt;) -&gt; result&lt;_, stream-error&gt;;
    }

    variant stream-error {
      last-operation-failed(error),
      closed,
    }
  }
}

package wasi:cli@0.2.0 {
  interface stdout {
    use wasi:io/streams@0.2.0.{output-stream};

    get-stdout: func() -&gt; output-stream;
  }
}


package wasi:random@0.2.0 {
  interface random {
    get-random-u64: func() -&gt; u64;
  }
}
</code></pre>
<p>Now, create your Go project:</p>
<pre><code class="language-console">$ mkdir add &amp;&amp; cd add
$ go mod init example.com
</code></pre>
<p>Next, we can generate the bindings for the <code>add.wit</code> file:</p>
<pre><code class="language-console">$ go get go.bytecodealliance.org/cmd/wit-bindgen-go
$ go run go.bytecodealliance.org/cmd/wit-bindgen-go generate -o internal/ ./add.wit
</code></pre>
<p>The <code>internal</code> directory will contain the generated Go code for the <code>add.wit</code> file.</p>
<pre><code class="language-console">$ tree internal
internal
 docs
    adder
        adder
            adder.exports.go
            adder.wasm.go
            adder.wit
            adder.wit.go
            empty.s
 wasi
     cli
        stdout
            empty.s
            stdout.wasm.go
            stdout.wit.go
     io
        error
           empty.s
           error.wit.go
           ioerror.wasm.go
        streams
            empty.s
            streams.wasm.go
            streams.wit.go
     random
         random
             empty.s
             random.wasm.go
             random.wit.go
</code></pre>
<p>The <code>adder.exports.go</code> file contains the exported functions that need to be implemented in the Go code called <code>Exports</code>.</p>
<h2 id="3-implement-the-add-function"><a class="header" href="#3-implement-the-add-function">3. Implement the <code>add</code> Function</a></h2>
<pre><code class="language-Go">package main

import (
	"example.com/internal/example/component/example"
)

func init() {
	example.Exports.Add = func(x int32, y int32) int32 {
		return x + y
	}
}

// main is required for the `wasi` target, even if it isn't used.
func main() {}
</code></pre>
<p>Go's <code>init</code> functions are used to do initialization tasks that
should be done before any other tasks. In this case, we are using it to export the <code>Add</code> function.</p>
<h2 id="4-build-the-component"><a class="header" href="#4-build-the-component">4. Build the Component</a></h2>
<p>We can build our component using TinyGo by specifying the wit-package to be <code>add.wit</code> and the WIT world to be <code>adder</code>.</p>
<p>Under the hood, TinyGo invokes <code>wasm-tools</code> to embed the WIT file to the module and componentize it.</p>
<pre><code class="language-console">$ tinygo build -target=wasip2 -o add.wasm --wit-package add.wit --wit-world adder main.go
</code></pre>
<p>We now have an add component that satisfies our <code>adder</code> world, exporting the <code>add</code> function, which
we can confirm using the <code>wasm-tools component wit</code> command:</p>
<pre><code class="language-console">$ wasm-tools component wit add.wasm
package root:component;

world root {
  import wasi:io/error@0.2.0;
  import wasi:io/streams@0.2.0;
  import wasi:cli/stdout@0.2.0;
  import wasi:random/random@0.2.0;

  export add: func(x: s32, y: s32) -&gt; s32;
}
...
</code></pre>
<h2 id="5-testing-the-add-component"><a class="header" href="#5-testing-the-add-component">5. Testing the <code>add</code> Component</a></h2>
<p>To run our add component, we need to use a host program with a WASI runtime that understands the
<code>example</code> world. We've provided an <a href="language-support/../../examples/example-host/README.html"><code>example-host</code></a> to do
just that. It calls the <code>add</code> function of a passed in component providing two operands. To use it,
clone this repository and run the Rust program:</p>
<pre><code class="language-console">git clone git@github.com:bytecodealliance/component-docs.git
cd component-docs/component-model/examples/example-host
cargo run --release -- 1 2 /path/to/add.wasm
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="javascript-tooling"><a class="header" href="#javascript-tooling">JavaScript Tooling</a></h1>
<p><a href="https://developer.mozilla.org/en-US/docs/WebAssembly">WebAssembly</a> was originally developed as a technology for running non-Javascript workloads in the browser at near-native speed.</p>
<p>Javascript WebAssembly component model support is provided primarily by <a href="https://github.com/bytecodealliance/jco"><code>jco</code></a>, a command line tool
which provides tooling for building WebAssembly components.</p>
<p><a href="https://typescriptlang.org">Typescript</a> can <em>also</em> be used, given that it is transpiled to JS first by relevant tooling (<code>tsc</code>).
<code>jco</code> generates <a href="https://www.typescriptlang.org/docs/handbook/declaration-files/deep-dive.html#declaration-file-theory-a-deep-dive">type declaration files (<code>.d.ts</code>)</a> by default, and also has a <code>jco types</code>
subcommand which generates typings that can be used with a Typescript codebase.</p>
<div class="mdbook-alerts mdbook-alerts-warning">
<p class="mdbook-alerts-title">
  <span class="mdbook-alerts-icon"></span>
  warning
</p>
<p>While popular projects like <a href="https://emscripten.org/"><code>emscripten</code></a> also build WebAssembly modules, those modules are not Component Model aware.</p>
<p>Core WebAssembly modules do not contain the advanced features (rich types, structured language interoperation, composition)
that the component model makes available.</p>
</div>
<h2 id="installing-jco"><a class="header" href="#installing-jco">Installing <code>jco</code></a></h2>
<p>Installing <a href="https://github.com/bytecodealliance/jco"><code>jco</code></a> (and its required peer dependency <a href="https://github.com/bytecodealliance/ComponentizeJS"><code>componentize-js</code></a>) can be done via NodeJS project tooling:</p>
<pre><code class="language-console">npm install -g @bytecodealliance/componentize-js @bytecodealliance/jco
</code></pre>
<div class="mdbook-alerts mdbook-alerts-note">
<p class="mdbook-alerts-title">
  <span class="mdbook-alerts-icon"></span>
  note
</p>
<p><code>jco</code> and <code>componentize-js</code> can be installed in a project-local manner with <code>npm install -D</code></p>
</div>
<p><a href="https://github.com/bytecodealliance/ComponentizeJS">ComponentizeJS</a> provides tooling used by <code>jco</code> to transpile JS to Wasm, so installing both packages is required.</p>
<h2 id="overview-of-building-a-component-with-javascript"><a class="header" href="#overview-of-building-a-component-with-javascript">Overview of Building a Component with Javascript</a></h2>
<p>Building a WebAssembly component with Javascript often consists of:</p>
<ol>
<li>Determining which interface our functionality will target (i.e. a <a href="https://github.com/WebAssembly/component-model/blob/main/design/mvp/WIT.md">WebAssembly Interface Types ("WIT")</a> world)</li>
<li>Writing Javscript that satisfies the interface</li>
<li>Packaging our project Javscript as WebAssembly (whether for use in WebAssembly runtimes, other JS projects, or the browser)</li>
</ol>
<p><a href="https://github.com/WebAssembly/component-model/blob/main/design/mvp/WIT.md">WebAssembly Interface Types ("WIT")</a> is a featureful Interface Definition Language ("IDL") for defining functionality, but most
of the time, you shouldn't need to write WIT from scratch. Often, it's sufficient to download a pre-existing interface that defines what
your component should do.</p>
<p>The <a href="https://github.com/bytecodealliance/component-docs/tree/main/component-model/examples/example-host/add.wit"><code>example</code> world</a> exports a single <code>add</code> function that sums two numbers:</p>
<pre><code class="language-wit">package example:component;

world example {
    export add: func(x: s32, y: s32) -&gt; s32;
}
</code></pre>
<div class="mdbook-alerts mdbook-alerts-note">
<p class="mdbook-alerts-title">
  <span class="mdbook-alerts-icon"></span>
  note
</p>
<p><code>export</code>ing the <code>add</code> function means that environments that interact with the resulting WebAssembly component
will be able to <em>call</em> the <code>add</code> function.</p>
<p>To learn more about the WIT syntax, check out the <a href="https://component-model.bytecodealliance.org/design/wit.html">WIT explainer</a></p>
</div>
<h2 id="implementing-a-js-webassembly-component"><a class="header" href="#implementing-a-js-webassembly-component">Implementing a JS WebAssembly Component</a></h2>
<p>To implement the <a href="https://github.com/bytecodealliance/component-docs/tree/main/component-model/examples/example-host/add.wit"><code>example</code> world</a>, we must write a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules">JavaScript module</a>
that implements the exported <code>add</code> function:</p>
<pre><code class="language-js">export const add = (x, y) =&gt; {
  return x + y;
};
</code></pre>
<div class="mdbook-alerts mdbook-alerts-warning">
<p class="mdbook-alerts-title">
  <span class="mdbook-alerts-icon"></span>
  warning
</p>
<p>When building your Javascript project, ensure to set the <code>"type":"module"</code> option in <code>package.json</code>,
as <code>jco</code> works exclusively with Javascript modules.</p>
</div>
<p>In the code above, the <code>example</code> world is analogous to the Javascript module itself, with the exported <code>add</code> function
mirroring <code>add</code> function <code>export</code>ed in the WIT.</p>
<p>With the WIT and Javascript in place, we can use <a href="https://github.com/bytecodealliance/jco"><code>jco</code></a> to create a WebAssembly component from the JS module, using <code>jco componentize</code>.</p>
<p>Our component is <em>so simple</em> (reminiscent of <a href="https://webassembly.github.io/spec/core/">Core WebAssembly</a>, which deals primarily in numeric values) that we're actually <em>not using</em> any of the <a href="https://wasi.dev/">WebAssembly System Interface</a> -- this means that we can <code>--disable</code> it when we invoke <code>jco componentize</code></p>
<pre><code class="language-console">jco componentize \
    path/to/add.js \
    --wit path/to/add.wit \
    --world-name example \
    --out add.wasm \
    --disable all
</code></pre>
<div class="mdbook-alerts mdbook-alerts-note">
<p class="mdbook-alerts-title">
  <span class="mdbook-alerts-icon"></span>
  note
</p>
<p>If you're using <code>jco</code> as a project-local dependency, you can run <code>npx jco</code></p>
</div>
<p>You should see output like the following:</p>
<pre><code>OK Successfully written add.wasm.
</code></pre>
<h2 id="running-the-component-in-the-example-host"><a class="header" href="#running-the-component-in-the-example-host">Running the Component in the <code>example-host</code></a></h2>
<p>To run the component we've built, we can use the <a href="https://github.com/bytecodealliance/component-docs/tree/main/component-model/examples/example-host"><code>example-host</code> project</a>:</p>
<pre><code class="language-console">cd component-model/examples/example-host
cargo run --release -- 1 2 ../path/to/add.wasm
1 + 2 = 3
</code></pre>
<div class="mdbook-alerts mdbook-alerts-warning">
<p class="mdbook-alerts-title">
  <span class="mdbook-alerts-icon"></span>
  warning
</p>
<p>The <a href="https://github.com/bytecodealliance/component-docs/tree/main/component-model/examples/example-host"><code>example-host</code> Rust project</a> uses the <a href="https://www.rust-lang.org/tools/install">Rust toolchain</a>, in particular <a href="https://doc.rust-lang.org/cargo"><code>cargo</code></a>,
so to run the code in this section you may need to install some more dependencies.</p>
</div>
<p>While the output isn't exciting, the code contained in <code>example-host</code> does a lot to make it happen:</p>
<ul>
<li>Loads the WebAssembly binary at the provided path (in the command above, <code>../path/to/add.wasm</code>)</li>
<li>Calls the <code>export</code>ed <code>add</code> function with arguments</li>
<li>Prints the result</li>
</ul>
<p>The important Rust code looks like this:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>let component = Component::from_file(&amp;engine, path).context("Component file not found")?;

let (instance, _) = Example::instantiate_async(&amp;mut store, &amp;component, &amp;linker)
    .await
    .context("Failed to instantiate the example world")?;

instance
    .call_add(&amp;mut store, x, y)
    .await
    .context("Failed to call add function")
<span class="boring">}</span></code></pre></pre>
<p>A quick reminder on the power and new capabilities afforded by WebAssembly -- we've written, loaded, instantiated and executed Javascript from Rust with a strict interface, without the need for FFI, subprocesses or a network call.</p>
<h2 id="running-a-component-from-javascript-applications-including-the-browser"><a class="header" href="#running-a-component-from-javascript-applications-including-the-browser">Running a Component from JavaScript Applications (including the Browser)</a></h2>
<p>JavaScript runtimes available in browsers cannot yet execute WebAssembly components, so WebAssembly components
(Javascript or otherwise) must be "transpiled" into a JavaScript wrapper and one or more <a href="https://webassembly.github.io/spec/core/binary/modules.html">WebAssembly core modules</a>
which <em>can</em> be run by in-browser WebAssembly runtimes.</p>
<p>Given an existing WebAssembly component (e.g. <code>add.wasm</code> which implements the <a href="https://github.com/bytecodealliance/component-docs/tree/main/component-model/examples/example-host/add.wit"><code>example</code> world</a>), we can "transpile" the component into runnable Javscript by using <code>jco tranpsile</code>:</p>
<pre><code class="language-console">jco transpile add.wasm -o dist
</code></pre>
<p>You should see output similar to the following:</p>
<pre><code>  Transpiled JS Component Files:

 - dist/add.core.wasm                   10.1 MiB
 - dist/add.d.ts                         0.1 KiB
 - dist/add.js                          1.57 KiB
</code></pre>
<div class="mdbook-alerts mdbook-alerts-note">
<p class="mdbook-alerts-title">
  <span class="mdbook-alerts-icon"></span>
  note
</p>
<p>To follow along, see the <a href="https://github.com/bytecodealliance/jco/tree/main/examples/components/add"><code>jco</code> example <code>add</code> component</a>.</p>
<p>With the project pulled locally, you also run <code>npm run transpile</code> which outputs to <code>dist/transpiled</code></p>
</div>
<p>Thanks to <code>jco</code> transpilation, you can import the resulting <code>dist/add.js</code> file and run it from any JavaScript application
using a runtime that supports the <a href="https://webassembly.github.io/spec/core/">core WebAssembly specification</a> as implemented for Javascript.</p>
<p>To use this component from <a href="https://nodejs.org/en">NodeJS</a>, you can write code like the following:</p>
<pre><code class="language-mjs">import { add } from "./dist/add.js";

console.log("1 + 2 = " + add(1, 2));
</code></pre>
<p>You can execute the Javascript module with <code>node</code> directly:</p>
<pre><code class="language-console">node run.js
</code></pre>
<p>You should see output like the following:</p>
<pre><code>1 + 2 = 3
</code></pre>
<p>This is directly comparable to the Rust host code mentioned in the previous section. Here, we are able to
use NodeJS as a host for running WebAssembly, thanks to <code>jco</code>'s ability to transpile components.</p>
<p>With <code>jco transpile</code> any WebAssembly binary (compiled from any language) can be run in Javascript natively.</p>
<h2 id="building-reactor-components-with-jco"><a class="header" href="#building-reactor-components-with-jco">Building Reactor Components with <code>jco</code></a></h2>
<p>Reactor components are WebAssembly components that are long running and meant to be called repeatedly over time. They're analogous to libraries of functionality rather than an executable (a "command" component).</p>
<p>Components expose their interfaces via <a href="language-support/../design/wit.html">WebAssembly Interface Types</a>, hand-in-hand with the <a href="language-support/../design/why-component-model.html">Component Model</a> which enables components to use higher level types interchangably.</p>
<h3 id="exporting-wit-interfaces-with-jco"><a class="header" href="#exporting-wit-interfaces-with-jco">Exporting WIT Interfaces with <code>jco</code></a></h3>
<p>Packaging reusable functionality into WebAssembly components isn't useful if we have no way to <em>expose</em> that functionality. This section offers a slightly deeper dive into the usage of WIT in WebAssembly components that can use the Component Model.</p>
<p>As in the previous example, <code>export</code>ing WIT interfaces for other components (or a WebAssembly host) to use is fundamental to developing WebAssembly programs.</p>
<p>Let's examine a <a href="https://github.com/bytecodealliance/jco/tree/main/examples/components/string-reverse"><code>jco</code> example project called <code>string-reverse</code></a> that exposes functionality for reversing a string.</p>
<p>To build a project like <code>string-reverse</code> from the ground up, first we'd start with a WIT like the following:</p>
<pre><code class="language-wit">package example:string-reverse@0.1.0

@since(version = 0.1.0)
interface reverse {
    reverse-string: func(s: string) -&gt; string;
}

world string-reverse {
    export reverse;
}
</code></pre>
<p>As a slightly deeper crash course on <a href="https://github.com/WebAssembly/component-model/blob/main/design/mvp/WIT.md">WIT</a>, here's what the above code describes:</p>
<ul>
<li>We've defined a namespace called <code>example</code></li>
<li>We've defined a package called <code>string-reverse</code> inside the <code>example</code> namespace</li>
<li>This WIT file corresponds to version <code>0.1.0</code> of <code>example:string-reverse</code> package</li>
<li>We've defined an interface called <code>reverse</code> which contains <em>one</em> function called <code>reverse-string</code></li>
<li>We specify that the <code>reverse</code> interface has existed <em>since</em> the <code>0.1.0</code> version</li>
<li>The <code>reverse-string</code> function (AKA. <code>example:reverse-string/reverse.reverse-string</code>) takes a string and returns a string</li>
<li>We've defined a <code>world</code> called <code>string-reverse</code> which exports the functionality provided by the <code>reverse</code> interface</li>
</ul>
<div class="mdbook-alerts mdbook-alerts-warning">
<p class="mdbook-alerts-title">
  <span class="mdbook-alerts-icon"></span>
  warning
</p>
<p>How do we <em>know</em> that <code>reverse</code> actually reverses a string?</p>
<p>Unfortunately, that problem is not really solvable at this level -- this is between you and the writer of the component that implements the WIT interface.</p>
<p>Of course, with WebAssembly, you <em>can</em> enforce static checks if you're so inclined, <em>before</em> you run any given binary.</p>
</div>
<p>OK now let's see what the JS code looks like to <em>implement</em> the <code>component</code> world:</p>
<pre><code class="language-js">/**
 * This module is the JS implementation of the `string-reverse` WIT world
 */

/**
 * This Javascript will be interpreted by `jco` and turned into a
 * WebAssembly binary with a single export (this `reverse` function).
 */
function reverseString(s) {
  return s.reverse();
}

/**
 * The Javascript export below represents the export of the `reverse` interface,
 * which which contains `reverse-string` as it's primary exported function.
 */
export const reverse = {
    reverseString,
};
</code></pre>
<div class="mdbook-alerts mdbook-alerts-note">
<p class="mdbook-alerts-title">
  <span class="mdbook-alerts-icon"></span>
  note
</p>
<p>To view the full code listing along with instructions, see the <a href="https://github.com/bytecodealliance/jco/tree/main/examples/components/string-reverse"><code>examples/tutorials/jco/string-reverse</code> folder</a></p>
</div>
<p>To use <code>jco</code> to compile this component, you can run the following from the <code>string-reverse</code> folder:</p>
<pre><code class="language-console">npx jco componentize \
    string-reverse.mjs \
    --wit wit/component.wit \
    --world-name component \
    --out string-reverse.wasm \
    --disable all
</code></pre>
<div class="mdbook-alerts mdbook-alerts-note">
<p class="mdbook-alerts-title">
  <span class="mdbook-alerts-icon"></span>
  note
</p>
<p>Like the previous example, we're not using any of the advanced <a href="https://wasi.dev/">WebAssembly System Interface</a> features, so we <code>--disable</code> all of them</p>
<p>Rather than typing out the <code>jco componentize</code> command manually, you can also run
the build command with <a href="https://github.com/bytecodealliance/jco/blob/main/examples/components/string-reverse/package.json#L6"><code>npm run build</code> from the <code>string-reverse</code> folder</a>.</p>
</div>
<p>You should see output like the following:</p>
<pre><code>OK Successfully written string-reverse.wasm.
</code></pre>
<p>Now that we have a WebAssembly binary, we can <em>also</em> use <code>jco</code> to run it in a native Javascript context by <em>transpiling</em> the WebAsssembly binary (which could have come from anywhere!) to a Javascript module.</p>
<pre><code class="language-console">npx jco transpile string-reverse.wasm -o dist/transpiled
</code></pre>
<p>You should see the following output:</p>
<pre><code>  Transpiled JS Component Files:

 - dist/transpiled/interfaces/example-string-reverse-reverse.d.ts   0.1 KiB
 - dist/transpiled/string-reverse.core.wasm                        10.1 MiB
 - dist/transpiled/string-reverse.d.ts                             0.15 KiB
 - dist/transpiled/string-reverse.js                               2.55 KiB
</code></pre>
<div class="mdbook-alerts mdbook-alerts-tip">
<p class="mdbook-alerts-title">
  <span class="mdbook-alerts-icon"></span>
  tip
</p>
<p>A gentle reminder that, transpilation <em>does</em> produce <a href="https://www.typescriptlang.org/docs/handbook/declaration-files/deep-dive.html#declaration-file-theory-a-deep-dive">Typescript declaration file</a>, for use in Typescript projects.</p>
</div>
<p>Now that we have a transpiled module, we can run it from any Javascript context that supports core WebAssembly (whether NodeJS or the browser).</p>
<p>For NodeJS, we can use code like the following:</p>
<pre><code class="language-mjs">// If this import listed below is missing, please run `npm run transpile`
import { reverse } from "./dist/transpiled/string-reverse.mjs";

const reversed = reverse.reverseString("!dlroW olleH");

console.log(`reverseString('!dlroW olleH') = ${reversed}`);
</code></pre>
<div class="mdbook-alerts mdbook-alerts-note">
<p class="mdbook-alerts-title">
  <span class="mdbook-alerts-icon"></span>
  note
</p>
<p>In the <code>jco</code> example project, you can run <code>npm run transpiled-js</code> to build the existing code.</p>
</div>
<p>Assuming you have the <code>dist/transpiled</code> folder populated (by running <code>jco transpile</code> in the previous step), you should see output like the following:</p>
<pre><code>reverseString('!dlrow olleh') = hello world!
</code></pre>
<p>While it's somewhat redundant in this context, what we've done from NodeJS demonstrates the usefulness of WebAssembly and the <code>jco</code> toolchain. With the help of <code>jco</code>, we have:</p>
<ul>
<li>Compiled Javascript to a WebAssembly module (<code>jco compile</code>), adhering to an interface defined via WIT</li>
<li>Converted the compiled WebAssembly module (which could be from <em>any</em> language) to a module that can be used from any compliant JS runtime (<code>jco transpile</code>)</li>
<li>Run the transpiled WebAssembly component from a Javascript native runtime (NodeJS)</li>
</ul>
<h3 id="advanced-importing-and-reusing-wit-interfaces-via-composition"><a class="header" href="#advanced-importing-and-reusing-wit-interfaces-via-composition">Advanced: Importing and Reusing WIT Interfaces via Composition</a></h3>
<p>Just as <code>export</code>ing functionality is core to building useful WebAssembly components, and similarly <code>import</code>ing and reusing functionality is key to using the strengths of WebAssembly.</p>
<p>Restated, <strong>WIT and the Component Model enable WebAssembly to <em>compose</em></strong>. This means we can build on top of functionality that already exists and <code>export</code> <em>new</em> functionality that depends on existing functionality.</p>
<p>Let's say in addition to the reversing the string (in the previous example) we want to build shared functionality that <em>also</em> upper cases the text it receives.</p>
<p>We can reuse the reversing functionality <em>and</em> export a new interface which enables us to reverse and upper-case.</p>
<p>Let's examine a <a href="https://github.com/bytecodealliance/jco/tree/main/examples/components/string-reverse-upper"><code>jco</code> example project called <code>string-reverse-upper</code></a> that exposes
functionality for reversing <em>and</em> upper-casing a string.</p>
<p>Here's the WIT one might write to enable this functionality:</p>
<pre><code class="language-wit">package example:string-reverse-upper@0.1.0;

@since(version = 0.1.0)
interface reversed-upper {
    reverse-and-uppercase: func(s: string) -&gt; string;
}

world revup {
    //
    // NOTE, the import below translates to:
    // &lt;namespace&gt;:&lt;package&gt;/&lt;interface&gt;@&lt;package version&gt;
    //
    import example:string-reverse/reverse@0.1.0;

    export reversed-upper;
}
</code></pre>
<p>This time, the <code>world</code> named <code>revup</code> that we are building <em>relies</em> on the interface <code>reverse</code> in the package <code>string-reverse</code> from the namespace <code>example</code>.</p>
<p>We can make use of <em>any</em> WebAssembly component that matches that interface, as long as we <em>compose</em> their functionality with the component that implements the <code>revup</code> world.</p>
<p>The <code>revup</code> world <code>import</code>s (and makes use) of <code>reverse</code> in order to <code>export</code> (provide) the <code>reversed-upper</code> interface, which contains the <code>reverse-and-uppercase</code> function (in JS, <code>reverseAndUppercase</code>).</p>
<div class="mdbook-alerts mdbook-alerts-note">
<p class="mdbook-alerts-title">
  <span class="mdbook-alerts-icon"></span>
  note
</p>
<p>Functionality is imported from the <code>interface</code>, <em>not</em> the <code>world</code>. <code>world</code>s can be included/used, but the syntax is slightly different for that.</p>
</div>
<p>The Javascript to make this work (<a href="https://github.com/bytecodealliance/jco/blob/main/examples/components/string-reverse-upper/string-reverse-upper.mjs"><code>string-reverse-upper.mjs</code> in <code>jco/examples</code></a>) looks like this:</p>
<pre><code class="language-js">/**
 * This module is the JS implementation of the `revup` WIT world
 */

/**
 * The import here is *virtual*. It refers to the `import`ed `reverse` interface in component.wit.
 *
 * These types *do not resolve* when the first `string-reverse-upper` component is built,
 * but the types are relevant for the resulting *composed* component.
 */
import { reverseString } from 'example:string-reverse/reverse@0.1.0';

/**
 * The Javascript export below represents the export of the `reversed-upper` interface,
 * which which contains `revup` as it's primary exported function.
 */
export const reversedUpper = {
  /**
   * Represents the implementation of the `reverse-and-uppercase` function in the `reversed-upper` interface
   *
   * This function makes use of `reverse-string` which is *imported* from another WebAssembly binary.
   */
  reverseAndUppercase() {
    return reverseString(s).toLocaleUpperCase();
  },
};
</code></pre>
<p>We can build the component with <code>jco componentize</code>:</p>
<pre><code class="language-console">npx jco componentize \
    string-reverse-upper.mjs \
    --wit wit/ \
    --world-name revup \
    --out string-reverse-upper.incomplete.wasm \
    --disable all
</code></pre>
<p>While we've successfully built a WebAssembly component, unlike the other examples, ours is <em>not yet complete</em>.</p>
<p>We can see that if we print the WIT of the generated component by running <code>jco wit</code>:</p>
<pre><code class="language-console">npx jco wit string-reverse-upper.incomplete.wasm
</code></pre>
<p>You should see output like the following:</p>
<pre><code>package root:component;

world root {
  import example:string-reverse/reverse@0.1.0;

  export example:string-reverse-upper/reversed-upper@0.1.0;
}
</code></pre>
<p>This tells us that the component still has <em>unfulfilled <code>import</code>s</em> -- we <em>use</em> the <code>reverseString</code> function that's in <code>reverse</code> as if it exists, but it's not yet a real part of the WebAssembly component (hence we've named it <code>.incomplete.wasm</code>.</p>
<p>To compose the two components (<code>string-reverse-upper/string-reverse-upper.incomplete.wasm</code> and <code>string-reverse/string-reverse.wasm</code> we built earlier), we'll need the <a href="https://github.com/bytecodealliance/wac">WebAssembly Composition tool (<code>wac</code>)</a>. We can use <code>wac plug</code>:</p>
<pre><code class="language-console">wac plug \
    -o string-reverse-upper.wasm \
    --plug ../string-reverse/string-reverse.wasm \
    string-reverse-upper.incomplete.wasm
</code></pre>
<div class="mdbook-alerts mdbook-alerts-note">
<p class="mdbook-alerts-title">
  <span class="mdbook-alerts-icon"></span>
  note
</p>
<p>You can also run this step with <code>npm run compose</code>.</p>
</div>
<p>A new component <code>string-reverse-upper.wasm</code> should now be present, which is a "complete" component -- we can check the output of <code>jco wit</code> to ensure that all the imports are satisfied:</p>
<pre><code class="language-wit">package root:component;

world root {
  export example:string-reverse-upper/reversed-upper@0.1.0;
}
</code></pre>
<p>It's as-if we never imported any functionality at all -- the functionality present in <code>string-reverse.wasm</code> has been <em>merged into</em> <code>string-reverse-upper.wasm</code>, and it now simply <code>export</code>s the advanced functionality.</p>
<p>We can run this completed component with in any WebAssembly-capable native Javascript environment by using a the transpiled result:</p>
<pre><code class="language-console">npx jco transpile string-reverse-upper.wasm -o dist/transpiled
</code></pre>
<div class="mdbook-alerts mdbook-alerts-note">
<p class="mdbook-alerts-title">
  <span class="mdbook-alerts-icon"></span>
  note
</p>
<p>In the example project, you can run <code>npm run transpile</code> instead, which will also change the extension on <code>dist/transpiled/string-reverse-upper.js</code> to <code>.mjs</code></p>
</div>
<p>You should see output like the following:</p>
<pre><code>  Transpiled JS Component Files:

 - dist/transpiled/interfaces/example-string-reverse-upper-reversed-upper.d.ts  0.12 KiB
 - dist/transpiled/string-reverse-upper.core.wasm                               10.1 MiB
 - dist/transpiled/string-reverse-upper.core2.wasm                              10.1 MiB
 - dist/transpiled/string-reverse-upper.d.ts                                    0.19 KiB
 - dist/transpiled/string-reverse-upper.js                                      6.13 KiB
</code></pre>
<div class="mdbook-alerts mdbook-alerts-tip">
<p class="mdbook-alerts-title">
  <span class="mdbook-alerts-icon"></span>
  tip
</p>
<p>Notice that there are <em>two</em> core WebAssembly files? That's because two core WebAssembly modules were involved
in creating the ultimate functionality we needed.</p>
</div>
<p>To run the transpiled component, we can write code like the following:</p>
<pre><code class="language-mjs">/**
 * If this import listed below is missing, please run
 *
 * ```
 * npm run build &amp;&amp; npm run compose &amp;&amp; npm run transpile`
 * ```
 */
import { reversedUpper } from "./dist/transpiled/string-reverse-upper.mjs";

const result = reversedUpper.reverseAndUppercase("!dlroW olleH");

console.log(`reverseAndUppercase('!dlroW olleH') = ${result}`);
</code></pre>
<div class="mdbook-alerts mdbook-alerts-note">
<p class="mdbook-alerts-title">
  <span class="mdbook-alerts-icon"></span>
  note
</p>
<p>In the <a href="https://github.com/bytecodealliance/jco/tree/main/examples/components/string-reverse-upper"><code>jco</code> example project</a>, you can run <code>npm run transpiled-js</code></p>
</div>
<p>You should see output like the following:</p>
<pre><code>reverseAndUppercase('!dlroW olleH') = HELLO WORLD!
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="python-tooling"><a class="header" href="#python-tooling">Python Tooling</a></h1>
<h2 id="building-a-component-with-componentize-py"><a class="header" href="#building-a-component-with-componentize-py">Building a Component with <code>componentize-py</code></a></h2>
<p><a href="https://github.com/dicej/componentize-py"><code>componentize-py</code></a> is a tool that converts a Python
application to a WebAssembly component.</p>
<p>First, install <a href="https://www.python.org/">Python 3.10 or later</a> and <a href="https://pypi.org/project/pip/">pip</a> if you don't already have them. Then, install <code>componentize-py</code>:</p>
<pre><code class="language-sh">pip install componentize-py
</code></pre>
<p>Next, create or download the WIT world you would like to target. For this example we will use an <a href="https://github.com/bytecodealliance/component-docs/tree/main/component-model/examples/example-host/add.wit"><code>example</code>
world</a> with an <code>add</code> function:</p>
<pre><code class="language-wit">package example:component;

world example {
    export add: func(x: s32, y: s32) -&gt; s32;
}
</code></pre>
<p>If you want to generate bindings produced for the WIT world (for an IDE or typechecker), you can generate them using the <code>bindings</code> subcommand. Specify the path to the WIT interface with the world you are targeting:</p>
<pre><code class="language-sh">$ componentize-py --wit-path /path/to/examples/example-host/add.wit --world example bindings .
</code></pre>
<blockquote>
<p>You do not need to generate the bindings in order to <code>componentize</code> in the next step. <code>componentize</code> will generate bindings on-the-fly and bundle them into the produced component.</p>
</blockquote>
<p>You can see that bindings were created in an <code>example</code> package which contains an <code>Example</code> protocol with an <code>add</code> method that we can implement:</p>
<pre><code class="language-sh">$ cat&lt;&lt;EOT &gt;&gt; app.py
import example

class Example(example.Example):
    def add(self, x: int, y: int) -&gt; int:
        return x + y
EOT
</code></pre>
<p>We now can compile our application to a Wasm component using the <code>componentize</code> subcommand:</p>
<pre><code class="language-sh">$ componentize-py --wit-path /path/to/examples/example-host/add.wit --world example componentize app -o add.wasm
Component built successfully
</code></pre>
<p>To test the component, run it using the <a href="language-support/./rust.html#creating-a-command-component-with-cargo-component">Rust <code>add</code> host</a>:</p>
<pre><code class="language-sh">$ cd component-model/examples/add-host
$ cargo run --release -- 1 2 ../path/to/add.wasm
1 + 2 = 3
</code></pre>
<p>See <a href="https://github.com/bytecodealliance/componentize-py/tree/main/examples"><code>componentize-py</code>'s examples</a> to try out build HTTP, CLI, and TCP components from Python applications.</p>
<h3 id="building-a-component-that-exports-an-interface-1"><a class="header" href="#building-a-component-that-exports-an-interface-1">Building a Component that Exports an Interface</a></h3>
<p>The <a href="https://github.com/bytecodealliance/component-docs/tree/main/component-model/examples/example-host/add.wit">sample <code>add.wit</code> file</a> exports a function. However, to use your component from another component, it must export an interface. That being said, you rarely find WIT that does not contain an interface. (Most WITs you'll see in the wild do use interfaces; we've been simplifying by exporting a function.) Let's expand our example world to export an interface rather than directly export the function.</p>
<pre><code class="language-wit">// add-interface.wit
package example:component;

interface add {
    add: func(a: u32, b: u32) -&gt; u32;
}

world example {
    export add;
}
</code></pre>
<p>If you peek at the bindings, you'll notice that we now implement a class for the <code>add</code> interface rather than for the <code>example</code> world. This is a consistent pattern. As you export more interfaces from your world, you implement more classes. Our add example gets the slight update of:</p>
<pre><code class="language-py"># app.py
import example

class Add(example.Example):
    def add(self, a: int, b: int) -&gt; int:
        return a + b
</code></pre>
<p>Once again, compile an application to a Wasm component using the <code>componentize</code> subcommand:</p>
<pre><code class="language-sh">$ componentize-py --wit-path add-interface.wit --world example componentize app -o add.wasm
Component built successfully
</code></pre>
<h2 id="running-components-from-python-applications"><a class="header" href="#running-components-from-python-applications">Running components from Python Applications</a></h2>
<p>Wasm components can also be invoked from Python applications. This walks through using tooling
to call the <a href="language-support/../../examples/example-host/add.wasm"><code>app.wasm</code> component from the examples</a>.</p>
<blockquote>
<p><code>wasmtime-py</code> does not currently support running components build with <code>componentize-py</code>. This is because <code>wasmtime-py</code> does not yet support <a href="language-support/../design/wit.html#resources">resources</a>, which components built with <code>componentize-py</code> always use, since <code>componentize-py</code> unconditionally imports most of the <code>wasi:cli</code> world.</p>
</blockquote>
<p>First, install <a href="https://www.python.org/">Python 3.11 or later</a> and <a href="https://pypi.org/project/pip/">pip</a> if you don't already have them. Then, install <a href="https://github.com/bytecodealliance/wasmtime-py"><code>wasmtime-py</code></a>:</p>
<pre><code class="language-sh">$ pip install wasmtime
</code></pre>
<p>First, generate the bindings to be able to call the component from a Python host application.</p>
<pre><code class="language-sh"># Get an add component that does not import the WASI CLI world
$ wget https://github.com/bytecodealliance/component-docs/raw/main/component-model/examples/example-host/add.wasm
$ python3 -m wasmtime.bindgen add.wasm --out-dir add
</code></pre>
<p>The generated package <code>add</code> has all of the requisite exports/imports for the
component and is annotated with types to assist with type-checking and
self-documentation as much as possible. Inside the package is a <code>Root</code> class
with an <code>add</code> function that calls the component's exported <code>add</code> function. We
can now write a Python program that calls <code>add</code>:</p>
<pre><code class="language-py">from add import Root
from wasmtime import Store

def main():
    store = Store()
    component = Root(store)
    print("1 + 2 = ", component.add(store, 1, 2))

if __name__ == '__main__':
    main()
</code></pre>
<p>Run the Python host program:</p>
<pre><code class="language-sh">$ python3 host.py
1 + 2 = 3
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="components-in-rust"><a class="header" href="#components-in-rust">Components in Rust</a></h1>
<p>Rust has first-class support for the component model via <a href="https://github.com/bytecodealliance/cargo-component">the <code>cargo component</code> tool</a>. It is a <code>cargo</code> subcommand for
creating WebAssembly components using Rust as the component's implementation language.</p>
<h2 id="installing-cargo-component"><a class="header" href="#installing-cargo-component">Installing <code>cargo component</code></a></h2>
<p>To install <code>cargo component</code>, run:</p>
<pre><code class="language-sh">cargo install cargo-component
</code></pre>
<blockquote>
<p>You can find more details about <code>cargo component</code> in its <a href="https://crates.io/crates/cargo-component">crates.io page</a>.</p>
</blockquote>
<h2 id="building-a-component-with-cargo-component"><a class="header" href="#building-a-component-with-cargo-component">Building a Component with <code>cargo component</code></a></h2>
<p>Create a Rust library that implements the <code>add</code> function in the <a href="https://github.com/bytecodealliance/component-docs/tree/main/component-model/examples/example-host/add.wit"><code>example</code>
world</a>. First scaffold a project:</p>
<pre><code class="language-sh">$ cargo component new add --lib &amp;&amp; cd add
</code></pre>
<p>Note that <code>cargo component</code> generates the necessary bindings as a module called <code>bindings</code>.</p>
<p>Next, update <code>wit/world.wit</code> to match <code>add.wit</code> and modify the component package reference to change the
package name to <code>example</code>. The <code>component</code> section of <code>Cargo.toml</code> should look like the following:</p>
<pre><code class="language-toml">[package.metadata.component]
package = "component:example"
</code></pre>
<p><code>cargo component</code> will generate bindings for the world specified in a package's <code>Cargo.toml</code>. In particular, it will create a <code>Guest</code> trait that a component should implement. Since our <code>example</code> world has no interfaces, the trait lives directly under the bindings module. Implement the <code>Guest</code> trait in <code>add/src/lib.rs</code> such that it satisfied the <code>example</code> world, adding an <code>add</code> function. It should look similar to the following:</p>
<pre><code class="language-rs">mod bindings;

use bindings::Guest;

struct Component;

impl Guest for Component {
    fn add(x: i32, y: i32) -&gt; i32 {
        x + y
    }
}
</code></pre>
<p>Now, use <code>cargo component</code> to build the component, being sure to optimize with a release build.</p>
<pre><code class="language-sh">$ cargo component build --release
</code></pre>
<p>You can use <code>wasm-tools component wit</code> to output the WIT package of the component:</p>
<pre><code class="language-sh">$ wasm-tools component wit target/wasm32-wasip1/release/add.wasm
package root:component;

world root {
  export add: func(x: s32, y: s32) -&gt; s32;
}
</code></pre>
<h3 id="running-a-component-from-rust-applications"><a class="header" href="#running-a-component-from-rust-applications">Running a Component from Rust Applications</a></h3>
<p>To verify that our component works, lets run it from a Rust application that knows how to run a
component targeting the <a href="https://github.com/bytecodealliance/component-docs/tree/main/component-model/examples/example-host/add.wit"><code>example</code> world</a>.</p>
<p>The application uses <a href="https://github.com/bytecodealliance/wasmtime"><code>wasmtime</code></a> crates to generate
Rust bindings, bring in WASI worlds, and execute the component.</p>
<pre><code class="language-sh">$ cd examples/example-host
$ cargo run --release -- 1 2 ../add/target/wasm32-wasip1/release/add.wasm
1 + 2 = 3
</code></pre>
<h2 id="exporting-an-interface-with-cargo-component"><a class="header" href="#exporting-an-interface-with-cargo-component">Exporting an interface with <code>cargo component</code></a></h2>
<p>The <a href="https://github.com/bytecodealliance/component-docs/tree/main/component-model/examples/example-host/add.wit">sample <code>add.wit</code> file</a> exports a function. However, to use your component from another component, it must export an interface. This results in slightly fiddlier bindings. For example, to implement the following world:</p>
<pre><code class="language-wit">package docs:adder@0.1.0;

interface add {
    add: func(a: u32, b: u32) -&gt; u32;
}

world adder {
    export add;
}
</code></pre>
<p>you would write the following Rust code:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>mod bindings;
// Separating out the interface puts it in a sub-module
use bindings::exports::docs::adder::add::Guest;

struct Component;

impl Guest for Component {
    fn add(a: u32, b: u32) -&gt; u32 {
        a + b
    }
}
<span class="boring">}</span></code></pre></pre>
<h2 id="importing-an-interface-with-cargo-component"><a class="header" href="#importing-an-interface-with-cargo-component">Importing an interface with <code>cargo component</code></a></h2>
<p>The world file (<code>wit/world.wit</code>) generated for you by <code>cargo component new --lib</code> doesn't specify any imports.</p>
<blockquote>
<p><code>cargo component build</code>, by default, uses the Rust <code>wasm32-wasi</code> target, and therefore automatically imports any required WASI interfaces - no action is needed from you to import these. This section is about importing custom WIT interfaces from library components.</p>
</blockquote>
<p>If your component consumes other components, you can edit the <code>world.wit</code> file to import their interfaces.</p>
<p>For example, suppose you have created and built an adder component as explained in the <a href="language-support/rust.html#exporting-an-interface-with-cargo-component">exporting an interface section</a> and want to use that component in a calculator component. Here is a partial example world for a calculator that imports the add interface:</p>
<pre><code class="language-wit">// in the 'calculator' project

// wit/world.wit
package docs:calculator;

interface calculate {
    eval-expression: func(expr: string) -&gt; u32;
}

world calculator {
    export calculate;
    import docs:adder/add@0.1.0;
}
</code></pre>
<h3 id="referencing-the-package-to-import"><a class="header" href="#referencing-the-package-to-import">Referencing the package to import</a></h3>
<p>Because the <code>docs:adder</code> package is in a different project, we must first tell <code>cargo component</code> how to find it. To do this, add the following to the <code>Cargo.toml</code> file:</p>
<pre><code class="language-toml">[package.metadata.component.target.dependencies]
"docs:adder" = { path = "../adder/wit" }  # directory containing the WIT package
</code></pre>
<p>Note that the path is to the adder project's WIT <em>directory</em>, not to the <code>world.wit</code> file. A WIT package may be spread across multiple files in the same directory; <code>cargo component</code> will look at all the files.</p>
<h3 id="calling-the-import-from-rust"><a class="header" href="#calling-the-import-from-rust">Calling the import from Rust</a></h3>
<p>Now the declaration of <code>add</code> in the adder's WIT file is visible to the <code>calculator</code> project. To invoke the imported <code>add</code> interface from the <code>calculate</code> implementation:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>// src/lib.rs
mod bindings;

use bindings::exports::docs::calculator::calculate::Guest;

// Bring the imported add function into scope
use bindings::docs::calculator::add::add;

struct Component;

impl Guest for Component {
    fn eval_expression(expr: String) -&gt; u32 {
        // Cleverly parse `expr` into values and operations, and evaluate
        // them meticulously.
        add(123, 456)
    }
}
<span class="boring">}</span></code></pre></pre>
<h3 id="fulfilling-the-import"><a class="header" href="#fulfilling-the-import">Fulfilling the import</a></h3>
<p>When you build this using <code>cargo component build</code>, the <code>add</code> interface remains imported. The calculator has taken a dependency on the <code>add</code> <em>interface</em>, but has not linked the <code>adder</code> implementation of that interface - this is not like referencing the <code>adder</code> crate. (Indeed, <code>calculator</code> could import the <code>add</code> interface even if there was no Rust project implementing the WIT file.) You can see this by running <a href="https://github.com/bytecodealliance/wasm-tools/tree/main/crates/wit-component"><code>wasm-tools component wit</code></a> to view the calculator's world:</p>
<pre><code># Do a release build to prune unused imports (e.g. WASI)
$ cargo component build --release

$ wasm-tools component wit ./target/wasm32-wasip1/release/calculator.wasm
package root:component;

world root {
  import docs:adder/add@0.1.0;

  export docs:calculator/calculate@0.1.0;
}
</code></pre>
<p>As the import is unfulfilled, the <code>calculator.wasm</code> component could not run by itself in its current form. To fulfill the <code>add</code> import, so that only <code>calculate</code> is exported, you would need to <a href="language-support/../creating-and-consuming/composing.html">compose the <code>calculator.wasm</code> with some <code>exports-add.wasm</code> into a single, self-contained component</a>.</p>
<h2 id="creating-a-command-component-with-cargo-component"><a class="header" href="#creating-a-command-component-with-cargo-component">Creating a command component with <code>cargo component</code></a></h2>
<p>A <em>command</em> is a component with a specific export that allows it to be executed directly by <code>wasmtime</code> (or other <code>wasm:cli</code> hosts). In Rust terms, it's the equivalent of an application (<code>bin</code>) package with a <code>main</code> function, instead of a library crate (<code>lib</code>) package.</p>
<p>To create a command with cargo component, run:</p>
<pre><code class="language-sh">cargo component new &lt;name&gt;
</code></pre>
<p>Unlike library components, this does <em>not</em> have the <code>--lib</code> flag. You will see that the created project is different too:</p>
<ul>
<li>It doesn't contain a <code>.wit</code> file. <code>cargo component build</code> will automatically export the <code>wasm:cli/run</code> interface for Rust <code>bin</code> packages, and hook it up to <code>main</code>.</li>
<li>Because there's no <code>.wit</code> file, <code>Cargo.toml</code> doesn't contain a <code>package.metadata.component.target</code> section.</li>
<li>The Rust file is called <code>main.rs</code> instead of <code>lib.rs</code>, and contains a <code>main</code> function instead of an interface implementation.</li>
</ul>
<p>You can write Rust in this project, just as you normally would, including importing your own or third-party crates.</p>
<blockquote>
<p>All the crates that make up your project are linked together at build time, and compiled to a <em>single</em> Wasm component. In this case, all the linking is happening at the Rust level: no WITs or component composition is involved. Only if you import Wasm interfaces do WIT and composition come into play.</p>
</blockquote>
<p>To run your command component:</p>
<pre><code class="language-sh">cargo component build
wasmtime run ./target/wasm32-wasip1/debug/&lt;name&gt;.wasm
</code></pre>
<blockquote>
<p><strong>WARNING:</strong> If your program prints to standard out or error, you may not see the printed output! Some versions of <code>wasmtime</code> have a bug where they don't flush output streams before exiting. To work around this, add a <code>std::thread::sleep()</code> with a 10 millisecond delay before exiting <code>main</code>.</p>
</blockquote>
<h3 id="importing-an-interface-into-a-command-component"><a class="header" href="#importing-an-interface-into-a-command-component">Importing an interface into a command component</a></h3>
<p>As mentioned above, <code>cargo component build</code> doesn't generate a WIT file for a command component. If you want to import a Wasm interface, though, you'll need to create a WIT file and a world, plus reference the packages containing your imports:</p>
<ol>
<li>
<p>Add a <code>wit/world.wit</code> to your project, and write a WIT world that imports the interface(s) you want to use. For example:</p>
<pre><code class="language-wit">package docs:app;

world app {
    import docs:calculator/calculate@0.1.0;
}
</code></pre>
<blockquote>
<p><code>cargo component</code> sometimes fails to find packages if versions are not set explicitly. For example, if the calculator WIT declares <code>package docs:calculator</code> rather than <code>docs:calculator@0.1.0</code>, then you may get an error even though <code>cargo component build</code> automatically versions the binary export.</p>
</blockquote>
</li>
<li>
<p>Edit <code>Cargo.toml</code> to tell <code>cargo component</code> about the new WIT file:</p>
<pre><code class="language-toml">[package.metadata.component.target]
path = "wit"
</code></pre>
<p>(This entry is created automatically for library components but not for command components.)</p>
</li>
<li>
<p>Edit <code>Cargo.toml</code> to tell <code>cargo component</code> where to find external package WITs:</p>
<pre><code class="language-toml">[package.metadata.component.target.dependencies]
"docs:calculator" = { path = "../calculator/wit" }
"docs:adder" = { path = "../adder/wit" }
</code></pre>
<blockquote>
<p>If the external package refers to other packages, you need to provide the paths to them as well.</p>
</blockquote>
</li>
<li>
<p>Use the imported interface in your Rust code:</p>
<pre><pre class="playground"><code class="language-rust">use bindings::docs::calculator::calculate::eval_expression;

fn main() {
    let result = eval_expression("1 + 1");
    println!("1 + 1 = {result}");
}</code></pre></pre>
</li>
<li>
<p><a href="language-support/../creating-and-consuming/composing.html">Compose the command component with the <code>.wasm</code> components that implement the imports.</a></p>
</li>
<li>
<p>Run the composed component:</p>
<pre><code class="language-sh">$ wasmtime run ./my-composed-command.wasm
1 + 1 = 579  # might need to go back and do some work on the calculator implementation
</code></pre>
</li>
</ol>
<h2 id="using-user-defined-types"><a class="header" href="#using-user-defined-types">Using user-defined types</a></h2>
<p><a href="language-support/../design/wit.html#user-defined-types">User-defined types</a> map to Rust types as follows.</p>
<div class="table-wrapper"><table><thead><tr><th>WIT type</th><th>Rust binding</th></tr></thead><tbody>
<tr><td><code>record</code></td><td><code>struct</code> with public fields corresponding to the record fields</td></tr>
<tr><td><code>variant</code></td><td><code>enum</code> with cases corresponding to the variant cases</td></tr>
<tr><td><code>enum</code></td><td><code>enum</code> with cases corresponding to the enum cases, with no data attached</td></tr>
<tr><td><code>resource</code></td><td><a href="language-support/rust.html#using-resources">See below</a></td></tr>
<tr><td><code>flags</code></td><td>Opaque type supporting bit flag operations, with constants for flag values</td></tr>
</tbody></table>
</div>
<p>For example, consider the following WIT:</p>
<pre><code class="language-wit">interface types {
    enum operation {
        add,
        sub,
        mul,
        div
    }

    record expression {
        left: u32,
        operation: operation,
        right: u32
    }

    eval: func(expr: expression) -&gt; u32;
}
</code></pre>
<p>When exported from a component, this could be implemented as:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>impl Guest for Implementation {
    fn eval(expr: Expression) -&gt; u32 {
        // Record fields become public fields on a struct
        let (l, r) = (expr.left, expr.right);
        match expr.operation {
            // Enum becomes an enum with only unit cases
            Operation::Add =&gt; l + r,
            Operation::Sub =&gt; l - r,
            Operation::Mul =&gt; l * r,
            Operation::Div =&gt; l / r,
        }
    }
}
<span class="boring">}</span></code></pre></pre>
<h2 id="using-resources"><a class="header" href="#using-resources">Using resources</a></h2>
<p><a href="language-support/../design/wit.html#resources">Resources</a> are handles to entities that live outside the component, for example in a host, or in a different component.</p>
<h3 id="example"><a class="header" href="#example">Example</a></h3>
<p>In this section, our example resource will be a <a href="https://en.wikipedia.org/wiki/Reverse_Polish_notation">Reverse Polish Notation (RPN)</a> calculator. (Engineers of a certain vintage will remember this from handheld calculators of the 1970s.) A RPN calculator is a stateful entity: a consumer pushes operands and operations onto a stack maintained within the calculator, then evaluates the stack to produce a value. The resource in WIT looks like this:</p>
<pre><code class="language-wit">package docs:rpn@0.1.0;

interface types {
    enum operation {
        add,
        sub,
        mul,
        div
    }

    resource engine {
        constructor();
        push-operand: func(operand: u32);
        push-operation: func(operation: operation);
        execute: func() -&gt; u32;
    }
}

world calculator {
    export types;
}
</code></pre>
<h3 id="implementing-and-exporting-a-resource-in-a-component"><a class="header" href="#implementing-and-exporting-a-resource-in-a-component">Implementing and exporting a resource in a component</a></h3>
<p>To implement the calculator using <code>cargo component</code>:</p>
<ol>
<li>
<p>Create a library component as shown in previous sections, with the WIT given above.</p>
</li>
<li>
<p>Define a Rust <code>struct</code> to represent the calculator state:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>use std::cell::RefCell;

struct CalcEngine {
    stack: RefCell&lt;Vec&lt;u32&gt;&gt;,
}
<span class="boring">}</span></code></pre></pre>
<blockquote>
<p>Why is the stack wrapped in a <code>RefCell</code>? As we will see, the generated Rust trait for the calculator engine has <em>immutable</em> references to <code>self</code>. But our implementation of that trait will need to mutate the stack. So we need a type that allows for interior mutability, such as <code>RefCell&lt;T&gt;</code> or <code>Arc&lt;RwLock&lt;T&gt;&gt;</code>.</p>
</blockquote>
</li>
<li>
<p>The generated bindings (<code>bindings.rs</code>) for an exported resource include a trait named <code>GuestX</code>, where <code>X</code> is the resource name. (You may need to run <code>cargo component build</code> to regenerate the bindings after updating the WIT.) For the calculator <code>engine</code> resource, the trait is <code>GuestEngine</code>. Implement this trait on the <code>struct</code> from step 2:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>use bindings::exports::docs::rpn::types::{GuestEngine, Operation};

impl GuestEngine for CalcEngine {
    fn new() -&gt; Self {
        CalcEngine {
            stack: RefCell::new(vec![])
        }
    }

    fn push_operand(&amp;self, operand: u32) {
        self.stack.borrow_mut().push(operand);
    }

    fn push_operation(&amp;self, operation: Operation) {
        let mut stack = self.stack.borrow_mut();
        let right = stack.pop().unwrap(); // TODO: error handling!
        let left = stack.pop().unwrap();
        let result = match operation {
            Operation::Add =&gt; left + right,
            Operation::Sub =&gt; left - right,
            Operation::Mul =&gt; left * right,
            Operation::Div =&gt; left / right,
        };
        stack.push(result);
    }

    fn execute(&amp;self) -&gt; u32 {
        self.stack.borrow_mut().pop().unwrap() // TODO: error handling!
    }
}
<span class="boring">}</span></code></pre></pre>
</li>
<li>
<p>We now have a working calculator type which implements the <code>engine</code> contract, but we must still connect that type to the <code>engine</code> resource type. This is done by implementing the generated <code>Guest</code> trait. For this WIT, the <code>Guest</code> trait contains nothing except an associated type. You can use an empty <code>struct</code> to implement the <code>Guest</code> trait on. Set the associated type for the resource - in our case, <code>Engine</code> - to the type which implements the resource trait - in our case, the <code>CalcEngine</code> <code>struct</code> which implements <code>GuestEngine</code>. Then use the <code>export!</code> macro to export the mapping:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>struct Implementation;
impl Guest for Implementation {
    type Engine = CalcEngine;
}

bindings::export!(Implementation with_types_in bindings);
<span class="boring">}</span></code></pre></pre>
</li>
</ol>
<p>This completes the implementation of the calculator <code>engine</code> resource. Run <code>cargo component build</code> to create a component <code>.wasm</code> file.</p>
<h3 id="importing-and-consuming-a-resource-in-a-component"><a class="header" href="#importing-and-consuming-a-resource-in-a-component">Importing and consuming a resource in a component</a></h3>
<p>To use the calculator engine in another component, that component must import the resource.</p>
<ol>
<li>
<p>Create a command component as shown in previous sections.</p>
</li>
<li>
<p>Add a <code>wit/world.wit</code> to your project, and write a WIT world that imports the RPN calculator types:</p>
<pre><code class="language-wit">package docs:rpn-cmd;

world app {
    import docs:rpn/types@0.1.0;
}
</code></pre>
</li>
<li>
<p>Edit <code>Cargo.toml</code> to tell <code>cargo component</code> about the new WIT file and the external RPN package file:</p>
<pre><code class="language-toml">[package.metadata.component]
package = "docs:rpn-cmd"

[package.metadata.component.target]
path = "wit"

[package.metadata.component.target.dependencies]
"docs:rpn" = { path = "../wit" } # or wherever your resource WIT is
</code></pre>
</li>
<li>
<p>The resource now appears in the generated bindings as a <code>struct</code>, with appropriate associated functions. Use these to construct a test app:</p>
<pre><pre class="playground"><code class="language-rust">#[allow(warnings)]
mod bindings;
use bindings::docs::rpn::types::{Engine, Operation};

fn main() {
    let calc = Engine::new();
    calc.push_operand(1);
    calc.push_operand(2);
    calc.push_operation(Operation::Add);
    let sum = calc.execute();
    println!("{sum}");
}</code></pre></pre>
</li>
</ol>
<p>You can now build the command component and <a href="language-support/../creating-and-consuming/composing.html">compose it with the <code>.wasm</code> component that implements the resource.</a>. You can then run the composed command with <code>wasmtime run</code>.</p>
<h3 id="implementing-and-exporting-a-resource-implementation-in-a-host"><a class="header" href="#implementing-and-exporting-a-resource-implementation-in-a-host">Implementing and exporting a resource implementation in a host</a></h3>
<p>If you are hosting a Wasm runtime, you can export a resource from your host for guests to consume. Hosting a runtime is outside the scope of this book, so we will give only a broad outline here. This is specific to the Wasmtime runtime; other runtimes may express things differently.</p>
<ol>
<li>
<p>Use <code>wasmtime::component::bindgen!</code> to specify the WIT you are a host for:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>wasmtime::component::bindgen!({
    path: "../wit"
});
<span class="boring">}</span></code></pre></pre>
</li>
<li>
<p>Tell <code>bindgen!</code> how you will represent the resource in the host via the <code>with</code> field. This can be any Rust type. For example, the RPN engine could be represented by a <code>CalcEngine</code> struct:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>wasmtime::component::bindgen!({
    path: "../wit",
    with: {
        "docs:rpn/types/engine": CalcEngine,
    }
});
<span class="boring">}</span></code></pre></pre>
<blockquote>
<p>If you don't specify the host representation for a resource, it defaults to an empty enum. This is rarely useful as resources are usually stateful.</p>
</blockquote>
</li>
<li>
<p>If the representation type isn't a built-in type, define it:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>struct CalcEngine { /* ... */ }
<span class="boring">}</span></code></pre></pre>
</li>
<li>
<p>As a host, you will already be implementing a <code>Host</code> trait. You will now need to implement a <code>HostX</code> trait (where <code>X</code> is the resource name) <em>on the same type</em> as the <code>Host</code> trait:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>impl docs::rpn::types::HostEngine for MyHost {
    fn new(&amp;mut self) -&gt; wasmtime::component::Resource&lt;docs::rpn::types::Engine&gt; { /* ... */ }
    fn push_operand(&amp;mut self, self_: wasmtime::component::Resource&lt;docs::rpn::types::Engine&gt;) { /* ... */ }
    // etc.
}
<span class="boring">}</span></code></pre></pre>
<blockquote>
<p><strong>Important:</strong> You implement this on the 'overall' host type, <em>not</em> on the resource representation! Therefore, the <code>self</code> reference in these functions is to the 'overall' host type. For instance methods of the resource, the instance is identified by a second parameter (<code>self_</code>), of type <code>wasmtime::component::Resource</code>.</p>
</blockquote>
</li>
<li>
<p>Add a <code>wasmtime::component::ResourceTable</code> to the host:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>struct MyHost {
    calcs: wasmtime::component::ResourceTable,
}
<span class="boring">}</span></code></pre></pre>
</li>
<li>
<p>In your resource method implementations, use this table to store and access instances of the resource representation:</p>
<pre><pre class="playground"><code class="language-rust"><span class="boring">#![allow(unused)]
</span><span class="boring">fn main() {
</span>impl docs::rpn::types::HostEngine for MyHost {
    fn new(&amp;mut self) -&gt; wasmtime::component::Resource&lt;docs::rpn::types::Engine&gt; {
        self.calcs.push(CalcEngine::new()).unwrap() // TODO: error handling
    }
    fn push_operand(&amp;mut self, self_: wasmtime::component::Resource&lt;docs::rpn::types::Engine&gt;) {
        let calc_engine = self.calcs.get(&amp;self_).unwrap();
        // calc_engine is a CalcEngine - call its functions
    }
    // etc.
}
<span class="boring">}</span></code></pre></pre>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="creating-and-consuming-components"><a class="header" href="#creating-and-consuming-components">Creating and Consuming Components</a></h1>
<p>The component model defines how components interface to each other and to hosts. This section describes how to work with components - from authoring them in custom code or by composing existing components, through to using them in applications and distributing them via registries.</p>
<div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="authoring-components"><a class="header" href="#authoring-components">Authoring Components</a></h1>
<p>You can write WebAssembly core modules in a wide variety of languages, and the set of languages that can directly create components is growing. See the <a href="creating-and-consuming/../language-support.html">Language Support</a> section for information on building components directly from source code.</p>
<p>If your preferred language supports WebAssembly but not components, you can still create components using the <a href="https://github.com/bytecodealliance/wasm-tools/tree/main/crates/wit-component"><code>wasm-tools component</code></a> tool.  (A future version of this page will cover this in more detail.)</p>
<div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="composing-components"><a class="header" href="#composing-components">Composing Components</a></h1>
<p>Because the WebAssembly component model packages code in a portable binary format, and provides machine-readable interfaces in <a href="creating-and-consuming/../design/wit.html">WIT</a> with a standardised ABI (Application Binary Interface), it enables applications and components to work together, no matter what languages they were originally written in. In the same way that, for example, a Rust package (crate) can be compiled together with other Rust code to create a higher-level library or an application, a Wasm component can be linked with other components.</p>
<blockquote>
<p>Component model interoperation is more convenient and expressive than language-specific foreign function interfaces. A typical C FFI involves language-specific types, so it is not possible to link between arbitrary languages without at least some C-language wrapping or conversion. The component model, by contrast, provides a common way of expressing interfaces, and a standard binary representation of those interfaces. So if an import and an export have the same shape, they fit together directly.</p>
</blockquote>
<h2 id="what-is-composition"><a class="header" href="#what-is-composition">What is composition?</a></h2>
<p>When you compose components, you wire up the imports of one "primary" component to the exports of one or more other "dependency" components, creating a new component. The new component, like the original components, is a <code>.wasm</code> file, and its interface is defined as:</p>
<ul>
<li>The new component <em>exports</em> the same exports as the primary component</li>
<li>The new component <em>does not export</em> the exports of the dependencies</li>
<li>The new component <em>imports</em> all the imports of the dependency components</li>
<li>The new component <em>imports</em> any imports of the primary component imports that the dependencies didn't satisfy</li>
<li>If several components import the same interface, the new component imports that interface - it doesn't "remember" that the import was declared in several different places</li>
</ul>
<p>For example, consider two components with the following worlds:</p>
<pre><code class="language-wit">// component `validator`
package docs:validator@0.1.0;

interface validator {
    validate-text: func(text: string) -&gt; string;
}

world validator {
    export validator;
    import docs:regex/match@0.1.0;
}
</code></pre>
<pre><code class="language-wit">// component 'regex'
package docs:regex@0.1.0;

interface match {
    first-match: func(regex: string, text: string) -&gt; string;
}

world regex {
    export match;
}
</code></pre>
<p>If we compose <code>validator</code> with <code>regex</code>, <code>validator</code>'s import of <code>docs:regex/match@0.1.0</code> is wired up to <code>regex</code>'s export of <code>match</code>. The net result is that the composed component exports <code>docs:validator/validator@0.1.0</code> and has no imports. The composed component does <em>not</em> export <code>docs:regex/match@0.1.0</code> - that has become an internal implementation detail of the composed component.</p>
<p>Component composition tools are in their early stages right now.  Here are some tips to avoid or diagnose errors:</p>
<ul>
<li>Composition happens at the level of interfaces. If the initial component directly imports functions, then composition will fail. If composition reports an error such as "component <code>path/to/component</code> has a non-instance import named <code>&lt;name&gt;</code>" then check that all imports and exports are defined by interfaces.</li>
<li>Composition is asymmetrical. It is not just "gluing components together" - it takes a primary component which has imports, and satisfies its imports using dependency components. For example, composing an implementation of <code>validator</code> with an implementation of <code>regex</code> makes sense because <code>validator</code> has a dependency that <code>regex</code> can satisfy; doing it the other way round doesn't work, because <code>regex</code> doesn't have any dependencies, let alone ones that <code>validator</code> can satisfy.</li>
<li>Composition cares about interface versions, and current tools are inconsistent about when they infer or inject versions. For example, if a Rust component exports <code>test:mypackage</code>, <code>cargo component build</code> will decorate this with the crate version, e.g. <code>test:mypackage@0.1.0</code>. If another Rust component <em>imports</em> an interface from <code>test:mypackage</code>, that won't match <code>test:mypackage@0.1.0</code>. You can use <a href="https://github.com/bytecodealliance/wasm-tools/tree/main/crates/wit-component"><code>wasm-tools component wit</code></a> to view the imports and exports embedded in the <code>.wasm</code> files and check whether they match up.</li>
</ul>
<h2 id="composing-components-with-wac"><a class="header" href="#composing-components-with-wac">Composing components with WAC</a></h2>
<p>You can use the <a href="https://github.com/bytecodealliance/wac">WAC</a> CLI to compose components at the command line.</p>
<p>To perform quick and simple compositions, use the <code>wac plug</code> command. <code>wac plug</code> satisfies the import of a "socket" component by plugging a "plug" component's export into the socket. For example, a component that implements the <a href="creating-and-consuming/composing.html#what-is-composition"><code>validator</code> world above</a> needs to satisfy it's <code>match</code> import. It is a socket. While a component that implements the <code>regex</code> world, exports the <code>match</code> interface, and can be used as a plug. <code>wac plug</code> can plug a regex component's export into the validator component's import, creating a resultant composition:</p>
<pre><code class="language-sh">wac plug validator-component.wasm --plug regex-component.wasm -o composed.wasm
</code></pre>
<p>A component can also be composed with two components it depends on.</p>
<pre><code class="language-sh">wac plug path/to/component.wasm --plug path/to/dep1.wasm --plug path/to/dep2.wasm -o composed.wasm
</code></pre>
<p>Here <code>component.wasm</code> is the component that imports interfaces from <code>dep1.wasm</code> and <code>dep2.wasm</code>, which export them. The composed component, with those dependencies satisfied and tucked away inside it, is saved to <code>composed.wasm</code>.</p>
<p>The <code>plug</code> syntax doesn't cover transitive dependencies. If, for example, <code>dep1.wasm</code> has unsatisfied imports that you want to satisfy from <code>dep3.wasm</code>, you'd need to be deliberate about the order of your composition. You could compose <code>dep1.wasm</code> with <code>dep3.wasm</code> first, then refer to that composed component instead of <code>dep1.wasm</code>. However, this doesn't scale to lots of transitive dependencies, which is why the WAC language was created.</p>
<h3 id="advanced-composition-with-the-wac-language"><a class="header" href="#advanced-composition-with-the-wac-language">Advanced composition with the WAC language</a></h3>
<p><code>wac plug</code> is a convenience to achieve a common pattern in component compositions like above. However, composition can be arbitrarily complicated. In cases where <code>wac plug</code> is not sufficient, the <a href="https://github.com/bytecodealliance/wac/blob/main/LANGUAGE.md">WAC language</a> can give us the ability to create arbitrarily complex compositions.</p>
<p>In a WAC file, you use the WAC language to describe a composition. For example, the following is a WAC file that could be used to create that validator component from <a href="creating-and-consuming/composing.html#what-is-composition">earlier</a>.</p>
<pre><code>//composition.wac
// Provide a package name for the resulting composition
package docs:composition;

// Instantiate the regex-impl component that implements the `regex` world. Bind this instance's exports to the local name `regex`.
let regex = new docs:regex-impl { };

// Instantiate the validator-impl component which implements the `validator` world and imports the match interface from the regex component.
let validator = new docs:validator-impl { match: regex.match, ... };

// Export all remaining exports of the validator instance
export validator...;
</code></pre>
<p>Then, <code>wac compose</code> can be used to compose the components, passing in the paths to the components. Alternatively, you can place the components in a <code>deps</code> directory with an expected structure, and in the near future, you will be able to pull in components from registries. See the <a href="https://github.com/bytecodealliance/wac"><code>wac</code> documentation</a> for more details.</p>
<pre><code class="language-sh">wac compose --dep docs:regex-impl=regex-component.wasm --dep docs:validator-impl=validator-component.wasm -o composed.wasm composition.wac
</code></pre>
<p>For an in depth description about how to use the wac tool, you can check out the <a href="https://github.com/bytecodealliance/wac/blob/main/LANGUAGE.md">wac language index</a> and <a href="https://github.com/bytecodealliance/wac/tree/main/examples">examples</a>.</p>
<h2 id="composing-components-with-a-visual-interface"><a class="header" href="#composing-components-with-a-visual-interface">Composing components with a visual interface</a></h2>
<p>You can compose components visually using the builder app at https://wasmbuilder.app/.</p>
<ol>
<li>
<p>Use the Add Component Button to upload the <code>.wasm</code> component files you want to compose. The components appear in the sidebar.</p>
</li>
<li>
<p>Drag the components onto the canvas. You'll see imports listed on the left of each component, and exports on the right.</p>
</li>
<li>
<p>Click the box in the top left to choose the 'primary' component, that is, the one whose exports will be preserved. (The clickable area is quite small - wait for the cursor to change from a hand to a pointer.)</p>
</li>
<li>
<p>To fulfil one of the primary component's imports with a dependency's export, drag from the "I" icon next to the export to the "I" item next to the import. (Again, the clickable area is quite small - wait for the cursor to change from a hand to a cross.)</p>
</li>
<li>
<p>When you have connected all the imports and exports that you want, click the Download Component button to download the composed component as a <code>.wasm</code> file.</p>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="running-components"><a class="header" href="#running-components">Running Components</a></h1>
<p>You can "run" a component by calling one of its exports. In some cases, this requires a custom host. For "command" components, though, you can use the <code>wasmtime</code> command line. This can be a convenient tool for testing components and exploring the component model. Other runtimes are also available - see the "Runtimes" section of the sidebar for more info.</p>
<blockquote>
<p>A "command" component is one that exports the <code>wasi:cli/run</code> interface, and imports only interfaces listed in the <a href="https://github.com/WebAssembly/wasi-cli/blob/main/wit/command.wit"><code>wasi:cli/command</code> world</a>.</p>
</blockquote>
<p>You must use a recent version of <code>wasmtime</code> (<a href="https://github.com/bytecodealliance/wasmtime/releases"><code>v14.0.0</code> or greater</a>), as earlier releases of the <code>wasmtime</code> command line do not include component model support.</p>
<p>To run your component, run:</p>
<pre><code class="language-sh">wasmtime run &lt;path-to-wasm-file&gt;
</code></pre>
<h2 id="running-components-with-custom-exports"><a class="header" href="#running-components-with-custom-exports">Running components with custom exports</a></h2>
<p>If you're writing a library-style component - that is, one that exports a custom API - then you can run it in <code>wasmtime</code> by writing a "command" component that imports and invokes your custom API. By <a href="creating-and-consuming/./composing.html">composing</a> the command and the library, you can exercise the library in <code>wasmtime</code>.</p>
<ol>
<li>
<p>Write your library component. The component's world (<code>.wit</code> file) must export an interface. (Do not export functions directly, only interfaces.) See the <a href="creating-and-consuming/../language-support.html">language support guide</a> for how to implement an export.</p>
</li>
<li>
<p>Build your library component to a <code>.wasm</code> file.</p>
</li>
<li>
<p>Write your command component. The component's world (<code>.wit</code> file) must import the interface exported from the library. Write the command to call the library's API. See the <a href="creating-and-consuming/../language-support.html">language support guide</a> for how to call an imported interface.</p>
</li>
<li>
<p>Build your command component to a <code>.wasm</code> file. You will not be able to run this in <code>wasmtime</code> yet, as its imports are not yet satisfied.</p>
</li>
<li>
<p>Compose your command component with your library component by running <code>wac plug &lt;path/to/command.wasm&gt; --plug &lt;path/to/library.wasm&gt; -o main.wasm</code>.</p>
</li>
<li>
<p>Run the composed component using <code>wasmtime run main.wasm</code></p>
</li>
</ol>
<p>See <a href="creating-and-consuming/./composing.html">Composing Components</a> for more details.</p>
<div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="distributing-components"><a class="header" href="#distributing-components">Distributing Components</a></h1>
<p>Modern applications rely extensively on third-party packages - so extensively that distributing packages is almost an industry in itself. Traditionally, these have been specific to a language. For example, JavaScript developers are used to using packages from NPM, and Rust developers use <code>crates.io</code>. Some runtimes support binary distribution and linking, enabling limited cross-language interop; for example, Maven packages can be written in any language that targets the Java runtime. Services like this are variously referred to as "package managers" or "registries."</p>
<p>Publishing and distribution are not defined by the core component model, but will form an important part of the component ecosystem. For example, if you're writing JavaScript, and want to pull in a highly optimised machine learning algorithm written in C and compiled to Wasm, you should be able to invoke it from a registry, just as easily as you would add a NPM package from the NPM registry.</p>
<p>Publishing and distribution is a work in progress. The proposed registry protocol is <a href="https://warg.io/">warg</a>, but this is still in development, and there are no public warg registries as yet. You can find more information about the development of the registry protocol <a href="https://github.com/bytecodealliance/governance/blob/main/SIGs/SIG-Registries/proposal.md">here</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="tutorial"><a class="header" href="#tutorial">Tutorial</a></h1>
<p>If you like to learn by doing, this tutorial will walk through how to build, compose, and run
components through a calculator example. Calculators can conduct many operations: add, subtract,
multiply, and so on. In this example, each operation will be a component, that will be composed with
an <code>eval-expression</code> component that will evaluate the expression using the expected operator. With
one operation per component, this calculator is exaggeratedly granular to show how independent logic
of an application can be contained in a component. In production, components will likely have a
larger scope than a simple mathematical operation.</p>
<p>Our eventual solution will involve three components: one for the calculator engine, one for the
addition operation, and one for the command-line interface. Once we have built these as separate
Wasm components, we will compose them into a single runnable component, and test it using the
<code>wasmtime</code> CLI.</p>
<h2 id="the-calculator-interface"><a class="header" href="#the-calculator-interface">The calculator interface</a></h2>
<p>For tutorial purposes, we are going to put our "calculator engine" and "addition operation" interfaces into two separate WIT packages, each containing one WIT file.  This may seem excessive, but the reason is to illustrate real-world use cases where components come from different authors and packages.
These files can be found in the component book repository in the <a href="https://github.com/bytecodealliance/component-docs/tree/main/component-model/examples/tutorial/wit"><code>wit</code> directory</a> under <code>wit/adder/world.wit</code> and <code>wit/calculator/world.wit</code>. These files define:</p>
<ul>
<li>
<p>A world describing an world that exports the "add" interface. Again, components such as the calculator can call it when
they need to add numbers.</p>
<pre><code class="language-wit">// wit/adder/world.wit
package docs:adder@0.1.0;

interface add {
    add: func(a: u32, b: u32) -&gt; u32;
}

world adder {
    export add;
}
</code></pre>
</li>
<li>
<p>An interface for the calculator itself.  We'll use this later to carry out calculations. It
contains an evaluate function, and an enum that delineates the operations that can be involved in
a calculation. In this tutorial, the only operation is <code>add</code>.</p>
</li>
<li>
<p>Interfaces for the various operations the calculator might need to carry out as part of a
calculation. For the tutorial, again, the only import we define is for the "add" operation from
the "docs:adder" world defined previously.</p>
</li>
<li>
<p>A world describing the calculator component. This world exports the calculator interface, meaning
that other components can call it to perform calculations. It imports the operation interfaces
(such as "add"), meaning it relies on other components to perform those operations.</p>
</li>
<li>
<p>A world describing the "primary" app component, which imports the "calculate" interface. This is
the component will take in command line arguments and pass them to the "eval-expression" function
of the calculator component.</p>
<pre><code class="language-wit">// wit/calculator/world.wit
package docs:calculator@0.1.0;

interface calculate {
    enum op {
        add,
    }
    eval-expression: func(op: op, x: u32, y: u32) -&gt; u32;
}

world calculator {
    export calculate;
    import docs:adder/add@0.1.0;
}

world app {
    import calculate;
}

</code></pre>
</li>
</ul>
<h2 id="create-an-add-component"><a class="header" href="#create-an-add-component">Create an <code>add</code> component</a></h2>
<p>Reference the <a href="language-support.html">language guide</a> and <a href="creating-and-consuming/authoring.html">authoring components
documentation</a> to create a component that implements the
<code>adder</code> world of <code>adder/wit/world.wit</code>. For reference, see the completed
<a href="https://github.com/bytecodealliance/component-docs/tree/main/component-model/examples/tutorial/adder/">example</a>.</p>
<h2 id="create-a-calculator-component"><a class="header" href="#create-a-calculator-component">Create a <code>calculator</code> component</a></h2>
<p>Reference the <a href="language-support.html">language guide</a> and <a href="creating-and-consuming/authoring.html">authoring components
documentation</a> to create a component that implements the
<code>calculator</code> world of <code>wit/calculator/world.wit</code>. For reference, see the completed
<a href="https://github.com/bytecodealliance/component-docs/tree/main/component-model/examples/tutorial/calculator/">example</a>. The component should import the <code>add</code> function from the
<code>adder</code> world and call it if the <code>op</code> enum matches <code>add</code>.</p>
<h2 id="create-a-command-component"><a class="header" href="#create-a-command-component">Create a <code>command</code> component</a></h2>
<p>A <em>command</em> is a component with a specific export that allows it to be executed directly by
<code>wasmtime</code> (or other <code>wasm:cli</code> hosts). The host expects it to export the <a href="https://github.com/WebAssembly/wasi-cli/blob/main/wit/run.wit"><code>wasi:cli/run</code>
interface</a>, which is the equivalent
of the <code>main</code> function to WASI. <code>cargo-component</code> will automatically resolve a Rust <code>bin</code> package
with a <code>main</code> function to a component with <code>wasi:cli/run</code> exported. Scaffold a new Wasm application
with a <code>command</code> component:</p>
<pre><code class="language-sh">cargo component new command --command
</code></pre>
<p>This component will implement the <a href="https://github.com/bytecodealliance/component-docs/tree/main/component-model/examples/tutorial/wit/calculator.wit"><code>app</code></a> world, which
imports the <code>calculate</code> interface. In <code>Cargo.toml</code>, point <code>cargo-component</code> to the WIT file and
specify that it should pull in bindings for the <code>app</code> world from the path to <code>calculator.wit</code>:</p>
<pre><code class="language-toml">[package.metadata.component.target]
path = "../wit/calculator/world.wit"
world = "app"
</code></pre>
<p>Since the calculator world imports the <code>add</code> interface, the command component needs to pull in the <code>adder</code> WIT as a dependency, as well.</p>
<pre><code class="language-toml">[package.metadata.component.target.dependencies]
"docs:adder" = { path = "../wit/adder" }
</code></pre>
<p>Now, implement a command line application that:</p>
<ol>
<li>takes in three arguments: two operands and the name of an operator ("1 2 add")</li>
<li>parses the operator name and ensures it is supported in the <code>op</code> enum</li>
<li>calls the <code>calculate</code> interface's <code>eval_expression</code>, passing in the arguments.</li>
</ol>
<p>For reference, see a completed <a href="https://github.com/bytecodealliance/component-docs/tree/main/component-model/examples/tutorial/command/">example</a>.</p>
<h2 id="composing-the-calculator"><a class="header" href="#composing-the-calculator">Composing the calculator</a></h2>
<p>Now, we are ready to bring our components together into one runnable calculator component, using
<code>wac</code>. We will first compose the calculator component with the add component to satisfy it's
imports. We then compose that resolved calculator component with the command component to satisfy
its <code>calculate</code> imports. The result is a command component that has all its imports satisfied and
exports the <code>wasi:cli/run</code> function, which can be executed by <code>wasmtime</code>.</p>
<pre><code class="language-sh">wac plug calculator.wasm --plug adder.wasm -o composed.wasm
wac plug command.wasm --plug composed.wasm -o final.wasm
</code></pre>
<blockquote>
<p>If you'd prefer to take a more visual approach to composing components, see the <a href="creating-and-consuming/composing.html#composing-components-with-a-visual-interface">documentation on composing components with wasmbuilder.app</a>.</p>
</blockquote>
<h2 id="running-the-calculator"><a class="header" href="#running-the-calculator">Running the calculator</a></h2>
<p>Now it all adds up! Run the final component with the <code>wasmtime</code> CLI, ensuring you are using a
<a href="https://github.com/bytecodealliance/wasmtime/releases"><code>v14.0.0</code> or greater release</a>, as earlier releases of
the <code>wasmtime</code> command line do not include component model support.</p>
<pre><code class="language-sh">wasmtime run final.wasm 1 2 add
1 + 2 = 3
</code></pre>
<h2 id="to-infinity-and-beyond"><a class="header" href="#to-infinity-and-beyond">To infinity and beyond!</a></h2>
<p>To expand the exercise to add more components, modify <code>calculator.wit</code> to add another operator world
and expand the <code>op</code> enum. Then, modify the <code>command</code> and <code>calculator</code> components to support the
expanded enum.</p>
<p>Another extension of this tutorial could be to remove the <code>op</code> enum and instead modify
<code>eval-expression</code> to take in a string that can then be parsed to determine which operator component
to call. Maybe this parser is a component of its own?!</p>
<div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="wasmtime"><a class="header" href="#wasmtime">Wasmtime</a></h1>
<p><a href="https://github.com/bytecodealliance/wasmtime/">Wasmtime</a> is the reference implementation of the Component Model. It supports running components that implement the <a href="https://github.com/WebAssembly/wasi-cli/blob/main/wit/command.wit"><code>wasi:cli/command</code> world</a> and serving components that implement the <a href="https://github.com/WebAssembly/wasi-http/blob/main/wit/proxy.wit"><code>wasi:http/proxy</code> world</a>.</p>
<h2 id="running-command-components-with-wasmtime"><a class="header" href="#running-command-components-with-wasmtime">Running command components with Wasmtime</a></h2>
<p>To run a command component with Wasmtime, execute:</p>
<pre><code class="language-sh">wasmtime run &lt;path-to-wasm-file&gt;
</code></pre>
<blockquote>
<p>If you are using an older version of <code>wasmtime</code>, you may need to add the <code>--wasm component-model</code> flag to specify that you are running a component rather than a core module.</p>
</blockquote>
<p>By default, Wasmtime denies the component access to all system resources. For example, the component cannot access the file system or environment variables. See the <a href="https://docs.wasmtime.dev/">Wasmtime guide</a> for information on granting access, and for other Wasmtime features.</p>
<h2 id="running-http-components-with-wasmtime"><a class="header" href="#running-http-components-with-wasmtime">Running HTTP components with Wasmtime</a></h2>
<p>You can now execute components that implement the <a href="https://github.com/WebAssembly/wasi-http/blob/main/wit/proxy.wit">HTTP proxy world</a> with the <code>wasmtime serve</code> subcommand. <a href="https://github.com/bytecodealliance/wasmtime">The Wasmtime CLI</a> supports serving these components as of <code>v14.0.3</code>.</p>
<p>To run a HTTP component with Wasmtime, execute:</p>
<pre><code class="language-sh">wasmtime serve &lt;path-to-wasm-file&gt;
</code></pre>
<p>Try out building and running HTTP components with one of these tutorials</p>
<ol>
<li>
<p><a href="https://github.com/sunfishcode/hello-wasi-http">Hello WASI HTTP tutorial</a> - build and serve a simple Rust-based HTTP component</p>
</li>
<li>
<p><a href="https://github.com/fermyon/http-auth-middleware#running-with-wasmtime">HTTP Auth Middleware tutorial</a> - compose a HTTP authentication middleware component with a business logic component</p>
</li>
</ol>
<div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="jco"><a class="header" href="#jco">jco</a></h1>
<p><a href="https://github.com/bytecodealliance/jco">jco</a> is a fully native JavaScript tool for working with components in JavaScript. It supports the <a href="https://github.com/WebAssembly/wasi-cli/blob/main/wit/command.wit"><code>wasi:cli/command</code> world</a>. <code>jco</code> also provides features for transpiling Wasm components to ES modules, and for building Wasm components from JavaScript and WIT.</p>
<p>To run a component with <code>jco</code>, run:</p>
<pre><code class="language-sh">jco run &lt;path-to-wasm-file&gt; &lt;command-args...&gt;
</code></pre>
<p><code>jco</code>'s WASI implementation grants the component full access to the underlying system resources. For example, the component can read all environment variables of the <code>jco</code> process, or read and write files anywhere in the file system.</p>
<div style="break-before: page; page-break-before: always;"></div><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<h1 id="canonical-abi"><a class="header" href="#canonical-abi">Canonical ABI</a></h1>
<p>An ABI is an <strong>application binary interface</strong> - an agreement on how to pass data around in a binary format. ABIs are specifically concerned with data layout at the bits-and-bytes level. For example, an ABI might define how integers are represented (big-endian or little-endian?), how strings are represented (pointer to null-terminated character sequence or length-prefixed? UTF-8 or UTF-16 encoded?), and how composite types are represented (the offsets of each field from the start of the structure).</p>
<p>The component model defines a <strong>canonical ABI</strong> - an ABI to which all <a href="advanced/../design/components.html">components</a> adhere. This guarantees that components can talk to each other without confusion, even if they are built in different languages. Internally, a C component might represent strings in a quite different way from a Rust component, but the canonical ABI provides a format for them to pass strings across the boundary between them.</p>
<blockquote>
<p>For a more formal definition of what the Canonical ABI is, take a look at the <a href="https://github.com/WebAssembly/component-model/blob/main/design/mvp/CanonicalABI.md">Canonical ABI explainer</a>.</p>
</blockquote>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->
        <script src="treesitter.js"></script>

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
